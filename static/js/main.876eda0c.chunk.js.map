{"version":3,"sources":["contexts.js","../ /^/.//.*$/ groupOptions: {} namespace object","components/DataLoader/DataLoader.js","components/DataLoader/index.js","helpers/palettes.js","components/GraphAnnotation/hooks.js","components/ControlButton/index.js","components/ControlButton/ControlButton.js","components/FiltersEditor/index.js","components/FiltersEditor/FiltersEditor.js","components/VariablesEditor/index.js","components/VariablesEditor/VariablesEditor.js","components/ColorLegend/ColorLegend.js","components/ColorLegend/index.js","components/GraphAnnotation/GraphControls.js","components/GraphAnnotation/reducers.js","components/DebouncedInput/index.js","components/DebouncedInput/DebouncedInput.js","components/GraphAnnotation/GraphContainer.js","components/FooterNav/FooterNav.js","components/FooterNav/index.js","components/GraphAnnotation/GraphAnnotation.js","components/GraphAnnotation/index.js","components/IceCreamAnnotation/IceCreamControls.js","components/IceCreamAnnotation/IceCreamContainer.js","components/IceCreamAnnotation/IceCreamAnnotation.js","components/IceCreamAnnotation/index.js","components/LinearGraphAnnotation/LinearGraphControls.js","components/LinearGraphAnnotation/LinearGraphContainer.js","components/LinearGraphAnnotation/LinearGraphAnnotation.js","summary.js","components/PlainPage/PlainPage.js","components/LinearGraphAnnotation/index.js","App.js","reportWebVitals.js","index.js","helpers/misc.js"],"names":["VisualizationControlContext","React","createContext","LanguageContext","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","Loader","percentsLoaded","className","style","width","DataLoader","url","children","useState","data","setData","loadingFraction","setLoadingFraction","useEffect","axios","get","onDownloadProgress","progressEvent","status","loaded","total","inputData","setTimeout","split","pop","csvParse","tsvParse","DEFAULT_COLOR_SPACE","cmin","cmax","lmin","lmax","SINGLE_COLOR_PALETTE","generatePalette","name","count","iwanthue","colorSpace","seed","clustering","usePrevious","value","ref","useRef","current","ControlButton","onClick","FiltersEditor","onToggleFiltersModeAnd","filtersModeAnd","filtersOptions","onFiltersChange","filters","isOpen","setIsOpen","undefined","newFilterAttribute","setNewFilterAttribute","newFilterOptions","options","forEach","option","push","length","index","attribute","newFilters","filter","f","i","onChange","val","target","entries","title","sort","a","b","VariablesEditor","variables","isNotAllDefault","find","v","type","localOptions","activeOptions","includes","getOptions","label","newVal","ColorItemHandler","modality","color","isEdited","setEdited","editedColor","setEditedColor","debouncedOnChange","debounce","background","stopPropagation","newColor","hex","ColorLegend","colorPalette","SLIDER_MARKS","DebouncedSlider","defaultValue","setValue","min","max","step","newValue","marks","GraphControls","rescale","zoomIn","zoomOut","searchString","onSearchStringChange","labelDensity","displayAllLabels","nodeSizeVariable","nodeColorVariable","nodeLabelVariable","onNodeSizeVariableChange","onNodeColorVariableChange","onNodeLabelVariableChange","onLabelDensityChange","onColorPaletteChange","onDisplayAllLabelsChange","isMinified","setIsMinified","cx","onSubmit","preventDefault","placeholder","DEFAULT_NODE_COLOR","DEFAULT_NODE_SIZE_RANGE","DebouncedInput","propsValue","propsOnChange","rest","propagateChange","useMemo","handleChange","renderer","getCamera","animatedReset","animatedZoom","animatedUnzoom","GraphContainer","graph","height","extents","onCameraUpdate","cameraPosition","updateTimestamp","legend","onTitleChange","onLegendChange","CELL_HEIGHT_RANGE","CELL_WIDTH_RANGE","cellHeightScale","scaleLinear","domain","range","cellWidthScale","nodeSize","values","Array","from","nodeColor","colors","size","palette","edgesMap","m","Map","_source","_target","sourceAttributes","targetAttributes","edge","_edgeAttributes","set","sourceNode","targetNode","previousNodeColor","previousNodeSize","previousNodeLabelVariable","previousLabelDensity","previousSearchString","previousFilters","previousColorPalette","previousFiltersModeAnd","previousDisplayAllLabels","nodeReducer","nodeLabel","nodeSizeFactor","nodeSizeScale","key","attr","renderedNode","x","y","evalIfNodeMatches","hidden","createNodeReducer","edgeReducer","el1","el2","renderedEdge","biggerNode","Color","lighten","rgb","string","createEdgeReducer","container","setRenderer","animate","needToRefresh","JSON","stringify","settings","actualLabelDensity","cellWidth","cellHeight","labelGrid","cell","displayedLabels","Set","highlightedNodes","forEachNode","attributes","displayedLabel","trim","highlightNode","unhighlightNode","toLowerCase","refresh","setContainer","useCallback","node","kill","newRenderer","WebGLRenderer","camera","getState","on","state","bind","GraphContainerWithDimensions","props","dimensions","FooterNav","prevPage","nextPage","lang","useContext","messages","next","fr","en","prev","to","route","GraphAnnotation","Content","contentsURL","gexf","parse","Graph","computeFiltersOptions","setCameraPosition","helpVisible","setHelpVisible","setSearchString","setFiltersModeAnd","Date","getTime","setUpdateTimeStamp","setFilters","setNodeColorVariable","setColorPalette","setNodeSizeVariable","setNodeLabelVariable","setLabelDensity","setTitle","setLegend","setDisplayAllLabels","hasLoadedFirstVis","setHasLoadedFirstVis","focusedVisualizationId","setFocusedVisualizationId","registeredVisualizations","setRegisteredVisualizations","onVisualizationUpdate","ratio","newSearchString","newFiltersModeAnd","newNodeColorVariable","newColorPalette","newTitle","newLegend","newDisplayAllLabels","thatId","sizes","sizeExtent","extent","Provider","onRegisterVisualization","onUnregisterVisualization","copyOfRegistered","visualizationParams","href","fallback","str","IceCreamControls","xVariable","reverseX","yVariable","reverseY","sizeVariable","colorVariable","labelVariable","labelsOnTheSide","colorScaleType","rotateMode","onToggleRotateMode","onXVariableChange","onYVariableChange","onColorVariableChange","onSizeVariableChange","onLabelVariableChange","onToggleLabelsOnTheSide","onToggleReverseX","onToggleReverseY","onColorScaleTypeChange","IceCreamContainer","inputColorPalette","zoomedIndex","setZoomedIndex","enableZoom","setEnableZoom","updateActive","found","smallestDimension","WIDTH","parseInt","Math","sqrt","HEIGHT","MIN_AREA","MAX_AREA","MARGIN","xRange","yRange","reverse","continuousColorScale","getX","getY","getSize","d","reduce","res","colorRange","highlightedIndex","datum","add","rotateTransform","rotate","translate","transf","transformGeometry","point1X","point1Y","point2X","point2Y","point3X","point3Y","point4X","point4Y","transform","points","fill","x1","y1","x2","y2","stroke","ticks","tick","textAnchor","onMouseEnter","onMouseLeave","radius","PI","xForXAxis","yForXAxis","xForYAxis","yForYAxis","labelX","labelY","pointerStartCoords","opacity","isMatching","has","isZoomed","strokeDasharray","cy","r","fontSize","IceCreamContainerWithDimensions","IceCreamAnnotation","setXVariable","setYVariable","setReverseX","setReverseY","setSizeVariable","setColorVariable","setLabelVariable","setLabelsOnTheSide","setColorScaleType","setRotateMode","thatXVariable","thatYVariable","thatReverseX","thatReverseY","thatSizeVariable","thatColorVariable","thatLabelVariable","thatLabelsOnTheSide","thatColorScaleType","thatRotateMode","thatSearchString","thatColorPalette","theseFilters","theseFiltersModeAnd","thisTitle","thisLegend","LinearGraphControls","xLabelVariable","graphType","useRelativeScale","onToggleUseRelativeScale","onGraphTypeChange","onXLabelVariableChange","LinearGraphContainer","xLabelMap","dict","dataGroups","group","_id","ys","sum","filteredY","xValue","xMap","res2","transformedValue","xValues","yPropToFilter","xExtent","nice","uniqBy","item","filtersAffectingColor","colorValue","newValues","getYHisto","getColor","yDisplace","firstX","firstY","path","index2","LinearGraphContainerWithDimensions","LinearGraphAnnotation","setXLabelVariable","setGraphType","setUseRelativeScale","thatXLabelVariable","thatGraphType","thatUseRelativeScale","finalPalette","routes","contents","Component","LANGUAGES","App","history","useHistory","setLang","renderRoute","ThatComponent","process","onLangChange","ln","otherLang","pathOtherLang","location","pathname","routeItem","inputRoute","lazy","repository","Wrapper","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","buildComponentCode","componentName","isArray","serializeValue","join","buildGraphCode","buildIceCreamScatterPlotCode","buildLinearGraphCode","args","computeTableOptions","computeGraphFiltersOptions","columns","uniq","isNaN","Number","isInteger","gexfData","attrs","DOMParser","parseFromString","querySelectorAll","categories","FORBIDDEN_ATTRS","getAttribute","_node","cat","cartesianToPolar","distance","radians","atan2","degrees","radiansToDegrees","polarToCartesian","degreesToRadians","cos","sin","finalDegrees","newX","newY"],"mappings":"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","file":"static/js/main.876eda0c.chunk.js","sourcesContent":["import React from 'react';\n\nexport const VisualizationControlContext = React.createContext({\n\n})\n\nexport const LanguageContext = React.createContext({\n\n})","var map = {\n\t\"./en/00_home.mdx\": [\n\t\t350,\n\t\t19\n\t],\n\t\"./en/01_couverture_media.mdx\": [\n\t\t351,\n\t\t3\n\t],\n\t\"./en/02_detectcritic.mdx\": [\n\t\t352,\n\t\t4\n\t],\n\t\"./en/03_graphclusters.mdx\": [\n\t\t353,\n\t\t5\n\t],\n\t\"./en/04_timelineclusters.mdx\": [\n\t\t354,\n\t\t6\n\t],\n\t\"./en/05_toporobotalgo.mdx\": [\n\t\t355,\n\t\t7\n\t],\n\t\"./en/06_explore_entities.mdx\": [\n\t\t356,\n\t\t8\n\t],\n\t\"./en/07_IssueVERB.mdx\": [\n\t\t357,\n\t\t9\n\t],\n\t\"./en/08_NERdate.mdx\": [\n\t\t358,\n\t\t10\n\t],\n\t\"./fr/00_home.mdx\": [\n\t\t359,\n\t\t20\n\t],\n\t\"./fr/01_couverture_media.mdx\": [\n\t\t360,\n\t\t11\n\t],\n\t\"./fr/02_detectcritic.mdx\": [\n\t\t361,\n\t\t12\n\t],\n\t\"./fr/03_graphclusters.mdx\": [\n\t\t362,\n\t\t13\n\t],\n\t\"./fr/04_timelineclusters.mdx\": [\n\t\t363,\n\t\t14\n\t],\n\t\"./fr/05_toporobotalgo.mdx\": [\n\t\t364,\n\t\t15\n\t],\n\t\"./fr/06_explore_entities.mdx\": [\n\t\t365,\n\t\t16\n\t],\n\t\"./fr/07_IssueVERB.mdx\": [\n\t\t366,\n\t\t17\n\t],\n\t\"./fr/08_NERdate.mdx\": [\n\t\t367,\n\t\t18\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 346;\nmodule.exports = webpackAsyncContext;","import React, {useEffect, useState} from 'react';\nimport axios from 'axios';\nimport { csvParse, tsvParse } from 'd3-dsv';\n\nconst Loader = ({percentsLoaded = 0}) =>{\n  return  (\n    <div className=\"loader-container\">\n      <div className=\"loader\">\n        <div className=\"loading-bar\" style={{width: percentsLoaded + '%'}} />\n      </div>\n   </div>\n)\n}\n\nconst DataLoader = ({url, children}) => {\n  const [data, setData] = useState(null);\n  const [loadingFraction, setLoadingFraction] = useState(0);\n  useEffect(() => {\n    if (url) {\n      axios.get(url, {\n        onDownloadProgress: progressEvent => {\n          const status = progressEvent.loaded / progressEvent.total;\n          setLoadingFraction(status);\n        }\n      })\n      .then(({data: inputData}) => {\n        setTimeout(() => {\n          let data = inputData;\n          if (url.split('.').pop() === 'csv') {\n            data = csvParse(inputData);\n          } else if (url.split('.').pop() === 'tsv') {\n            data = tsvParse(inputData);\n          }\n          setData(data);\n        })\n      })\n    }\n  }, [url]);\n\n  if (!url) {\n    return children();\n  }\n\n  return data ? children(data)\n  : \n  <Loader percentsLoaded={loadingFraction * 100} />\n}\n\n\nexport default DataLoader;","import DataLoader from './DataLoader'\n\nexport default DataLoader","import iwanthue from 'iwanthue';\n\nconst DEFAULT_COLOR_SPACE = {\n  cmin: 25.59,\n  cmax: 55.59,\n  lmin: 60.94,\n  lmax: 90.94\n};\n\nconst SINGLE_COLOR_PALETTE = ['#999'];\n\nexport function generatePalette(name, count) {\n  if (count === 1 || !count) return SINGLE_COLOR_PALETTE;\n  else if (count === 2) {\n    return ['#D77186', '#61A2DA']\n  }\n\n  return iwanthue(count, {\n    colorSpace: DEFAULT_COLOR_SPACE,\n    seed: name,\n    clustering: 'force-vector'\n  });\n}","import {useRef, useEffect} from 'react';\n// import Graph from 'graphology-types';\n\n\nexport function usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\n","import ControlButton from './ControlButton';\n\nexport default ControlButton;","import React from 'react';\n\nexport default function ControlButton({children, onClick}) {\n  return (\n    <button className=\"control-button\" onClick={onClick}>\n      {children}\n    </button>\n  );\n}","import FiltersEditor from './FiltersEditor';\n\nexport default FiltersEditor;","\nimport React, {useState} from 'react';\n\nimport ControlButton from '../ControlButton';\n\nexport default function FiltersEditor ({\n  onToggleFiltersModeAnd,\n  filtersModeAnd,\n  filtersOptions,\n  onFiltersChange,\n  filters\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [newFilterAttribute, setNewFilterAttribute] = useState(undefined);\n\n  let newFilterOptions = [];\n  if (newFilterAttribute) {\n    filtersOptions[newFilterAttribute].options.forEach(option => newFilterOptions.push(option))\n  }\n\n  const handleNewFilterSubmit = (e) => {\n    const value = e.target.value;\n    onFiltersChange([\n      ...filters,\n      {\n        attribute: newFilterAttribute,\n        value\n      }\n    ])\n    setNewFilterAttribute(undefined);\n  }\n  const handleNewFilterChange = e => {\n    const val = e.target.value;\n    if (val.length)\n      setNewFilterAttribute(val)\n  }\n  return (\n    <div className=\"FiltersEditor\">\n      <div>\n        <button className={isOpen ? 'is-active' : ''} onClick={() => setIsOpen(!isOpen)}>\n          Filtres ...\n        </button>\n      </div>\n      {\n        isOpen &&\n        <div>\n          <ControlButton  onClick={onToggleFiltersModeAnd}>\n            Mode des filtres: {filtersModeAnd ? 'AND (intersection des filtres)' : 'OR (union des filtres)'}\n          </ControlButton>\n          {filters.length ?\n          <div>\n            <h6>Filtres existants</h6>\n            <ul className=\"existing-filters\">\n              {\n                filters.map(({attribute, value}, index) => {\n                  const handleDelete = () => {\n                    let newFilters = filters.filter((f, i) => i !== index);\n                    onFiltersChange(newFilters);\n                  }\n                  return (\n                    <li key={index}>\n                      <div>\n                        {attribute} : {value}\n                      </div>\n                      <div>\n                        <button onClick={handleDelete}>\n                        🗑\n                        </button>\n                      </div>\n                    </li>\n                  )\n                })\n              }\n            </ul>\n          </div>\n          : null\n        }\n          <div>\n            <h6>Ajouter un nouveau filtre</h6>\n            <select value={newFilterAttribute || ''} onChange={handleNewFilterChange}>\n              {\n                Object.entries(filtersOptions).map(([id, {title}], index) => {\n                  return (\n                    <option value={id} key={index}>{title}</option>\n                  )\n                })\n              }\n              <option value=\"\">Selectionner</option>\n            </select>\n            {\n              newFilterAttribute !== undefined ?\n              <select value={''} onChange={handleNewFilterSubmit}>\n                {\n                  newFilterOptions\n                  .sort((a, b) => {\n                    if (a > b) {\n                      return 1;\n                    }\n                    return -1;\n                  })\n                  .map((id, index) => {\n                    return (\n                      <option value={id} key={index}>{id}</option>\n                    )\n                  })\n                }\n                <option value=\"\">Selectionner</option>\n              </select>\n              : null\n            }\n          </div>\n        </div>\n      }\n      \n    </div>\n  )\n}","import VariablesEditor from './VariablesEditor';\n\nexport default VariablesEditor;","import React, {useState} from 'react';\n\nexport default function VariablesEditor ({\n  options,\n  variables,\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const isNotAllDefault = variables.find(v => v.value !== 'default' && v.value !== undefined) !== undefined;\n  return (\n    <div className=\"FiltersEditor VariablesEditor\">\n      <div>\n        <button className={isOpen || isNotAllDefault ? 'is-active' : ''} onClick={() => setIsOpen(!isOpen)}>\n          Variables ...\n        </button>\n      </div>\n      {\n        (isOpen || isNotAllDefault) &&\n        <div>\n          {\n            variables.map(({title, value, onChange, type, localOptions}, index) => {\n              const getOptions = () => {\n                switch(type) {\n                  case 'color':\n                  case 'string':\n                    if (localOptions) {\n                      return localOptions;\n                    }\n                    return  Object.entries(options)\n                  case 'boolean':\n                    return [['true', {title: 'Oui'}], ['false', {title: 'Non'}]]\n                  case 'number':\n                  default:\n                    return Object.entries(options)\n                    .filter(([_id, option]) => ['integer', 'float'].includes(option.type))\n                }\n              }\n              const activeOptions = [\n                {\n                  value: 'default',\n                  title: 'Défaut'\n                },\n                ...getOptions()\n                  .map(([id, option]) => ({\n                    label: option.title,\n                    value: id\n                  }))\n              ]\n\n              if (activeOptions.length <= 1) {\n                return null;\n              }\n              return (\n                <div key={index}>\n                  <h6>{title} </h6>\n                  <select value={value} onChange={e => {\n                      const newVal = e.target.value;\n                      if (type === 'boolean') {\n                        return onChange(newVal === 'true' ? true : false)\n                      }\n                      return onChange(newVal)\n                    }}>\n                    {\n                      activeOptions.map(({value, label}) => (\n                        <option key={value} value={value}>\n                          {label || 'Défaut'}\n                        </option>\n                      ))\n                    }\n                  </select>\n                </div>\n              )\n            })\n          }\n        </div>\n      }\n      \n    </div>\n  )\n}","\nimport React, {useState, useEffect} from 'react';\nimport { SketchPicker } from 'react-color';\nimport debounce from 'lodash/debounce';\n\nconst ColorItemHandler = ({\n  modality,\n  onChange,\n  color\n}) => {\n  const [isEdited, setEdited] = useState(false);\n  const [editedColor, setEditedColor] = useState(color);\n  useEffect(() => {\n    setEditedColor(color)\n  }, [color]);\n  const debouncedOnChange = debounce(onChange, 300);\n  const handleChange = newColor => {\n    setEditedColor(newColor.hex);\n    debouncedOnChange(newColor.hex);\n  }\n  const handleClose = () => {\n    onChange(editedColor);\n    setEdited(false);\n  }\n  return (\n    <li>\n      <span onClick={() => setEdited(!isEdited)} className=\"legend-color\" style={{background: color}} />\n      <span className=\"legend-modality\">{modality}</span>\n      {\n        isEdited ?\n        <>\n          <div onClick={handleClose} className=\"color-picker-container\">\n            <div onClick={e => {e.stopPropagation()}}>\n              <h5>Choisir la couleur de la modalité \"{modality}\"</h5>\n              <SketchPicker onChange={handleChange} color={editedColor} />\n            </div>\n          </div>\n        </>\n        : null\n      }\n    </li>\n  )\n}\n\nexport default function ColorLegend ({\n  colorPalette,\n  onChange,\n}) {\n  if (!colorPalette) {\n    return null;\n  }\n  return (\n    <div className=\"ColorLegend\" >\n      <h6>Légende</h6>\n      <ul>\n        {\n          Object.entries(colorPalette)\n          .map(([modality, color]) => {\n            const handleChange = newColor => {\n              onChange({\n                ...colorPalette,\n                [modality] : newColor\n              })\n            }\n            return (\n              <ColorItemHandler onChange={handleChange} key={modality} {...{modality, color}} />\n            )\n          })\n        }\n      </ul>\n    </div>\n  );\n}","import ColorLegend from './ColorLegend';\n\nexport default ColorLegend;","import React, {useEffect, useState} from 'react';\nimport cx from 'classnames';\nimport Slider from 'rc-slider';\nimport debounce from 'lodash/debounce';\n\nimport ControlButton from '../ControlButton';\nimport FiltersEditor from '../FiltersEditor';\nimport VariablesEditor from '../VariablesEditor';\nimport ColorLegend from '../ColorLegend';\n\nconst SLIDER_MARKS = {\n  '0.25': 'défaut'\n};\n\nfunction DebouncedSlider({defaultValue, onChange}) {\n  const [value, setValue] = useState(defaultValue);\n\n  useEffect(() => {\n    setValue(defaultValue);\n  }, [defaultValue])\n\n  const onSliderChange = newValue => {\n    setValue(newValue);\n    onChange(newValue);\n  };\n\n  return (\n    <Slider\n      min={0}\n      max={1}\n      step={0.01}\n      defaultValue={defaultValue}\n      value={value}\n      onChange={onSliderChange}\n      marks={SLIDER_MARKS}\n    />\n  );\n}\n\n\nexport default function GraphControls({\n  rescale, \n  zoomIn, \n  zoomOut, \n  searchString = '',\n  onSearchStringChange,\n  filtersModeAnd,\n  onToggleFiltersModeAnd,\n  labelDensity,\n  displayAllLabels,\n\n  nodeSizeVariable,\n  nodeColorVariable,\n  nodeLabelVariable,\n\n  filtersOptions,\n  filters = [],\n  colorPalette,\n\n  onFiltersChange,\n  onNodeSizeVariableChange,\n  onNodeColorVariableChange,\n  onNodeLabelVariableChange,\n  onLabelDensityChange,\n  onColorPaletteChange,\n  onDisplayAllLabelsChange,\n}) {\n  const handleSearchChange = e => onSearchStringChange(e.target.value);\n  const [isMinified, setIsMinified] = useState(true)\n  return (\n    <>\n      <button onClick={() => setIsMinified(!isMinified)} className={cx('minify-button', {'is-active': !isMinified})}>\n        {'éditer'}\n      </button>\n      <ul className={cx(\"VisControls GraphControls\", {'is-minified': isMinified})}>\n        \n        <li className=\"vis-controls-item camera\">\n        \n        <ControlButton onClick={zoomOut}>\n          -\n        </ControlButton>\n        <ControlButton onClick={zoomIn}>\n          +\n        </ControlButton>\n        <ControlButton onClick={rescale}>\n          Recentrer\n        </ControlButton>\n        </li>\n        <li className=\"vis-controls-item\">\n          <form onSubmit={e => e.preventDefault()}>\n            <input type=\"text\" onChange={handleSearchChange} placeholder=\"rechercher\" value={searchString} />\n          </form>\n        </li>\n        \n        <li className=\"vis-controls-item\">\n          <VariablesEditor\n            {\n              ...{\n                options: filtersOptions,\n                variables: [{\n                    title: 'Taille des noeuds',\n                    onChange: onNodeSizeVariableChange,\n                    value: nodeSizeVariable,\n                    type: 'number'\n                  },\n                  {\n                    title: 'Couleur des noeuds',\n                    value: nodeColorVariable,\n                    onChange: onNodeColorVariableChange,\n                    type: 'color'\n                  },\n                  {\n                    title: 'Label des noeuds',\n                    value: nodeLabelVariable,\n                    onChange: onNodeLabelVariableChange,\n                    type: 'string'\n                  },\n                  {\n                    title: 'Afficher tous les labels',\n                    onChange: () => onDisplayAllLabelsChange(!displayAllLabels),\n                    localOptions: [[\n                      false,\n                      {title: 'non'}\n                    ], [\n                      true,\n                      {title: 'oui'}\n                    ]],\n                    value: displayAllLabels,\n                    type: 'boolean'\n                  },\n                ],\n              }\n            }\n          />\n        </li>\n        \n        <li className=\"vis-controls-item\">\n        <FiltersEditor\n          {\n            ...{\n              onToggleFiltersModeAnd,\n              filtersModeAnd,\n              filtersOptions,\n              onFiltersChange,\n              filters\n            }\n          }\n        />\n        </li>\n        <li className=\"vis-controls-item slider-wrapper\">\n          <form onSubmit={e => e.preventDefault()}>\n            <h5>Densité des labels</h5>\n            <div className=\"slider-container\">\n                <DebouncedSlider\n                  defaultValue={labelDensity}\n                  onChange={debounce(onLabelDensityChange, 300)}\n                />\n              </div>\n          </form>\n        </li>\n        {\n            nodeColorVariable && nodeColorVariable !== 'default' ?\n            <ColorLegend\n              colorPalette={colorPalette}\n              onChange={onColorPaletteChange}\n            />\n            : null\n          }\n      </ul>\n    </>\n  );\n}","import Color from 'color';\nimport {scaleLinear} from 'd3-scale';\nimport {evalIfNodeMatches} from '../../helpers/misc';\n\n\n// Defaults\nconst DEFAULT_NODE_COLOR = '#999';\nconst DEFAULT_NODE_SIZE_RANGE = [2, 15];\n\nexport function createNodeReducer({\n  nodeColor,\n  nodeSize,\n  nodeLabel,\n  nodeSizeFactor = 1,\n  extents,\n  filters = [],\n  filtersModeAnd,\n  colorPalette,\n}) {\n  let nodeSizeScale = null;\n\n  // Creating scales\n  if (!nodeSize) {\n    nodeSizeScale = scaleLinear()\n      .domain([extents.nodeSize.min, extents.nodeSize.max])\n      .range(DEFAULT_NODE_SIZE_RANGE);\n  } else {\n    nodeSizeScale = scaleLinear()\n      .domain([nodeSize.min, nodeSize.max])\n      .range(DEFAULT_NODE_SIZE_RANGE);\n  }\n  // Creating actual reducer\n  const nodeReducer = function (key, attr) {\n    const renderedNode = {\n      x: attr.x,\n      y: attr.y\n    };\n\n    // Color\n    if (!nodeColor) {\n      renderedNode.color = attr.color || DEFAULT_NODE_COLOR;\n    } else if (colorPalette) {\n      renderedNode.color = colorPalette[attr[nodeColor.name]] || DEFAULT_NODE_COLOR;\n    } else {\n      renderedNode.color =\n        nodeColor.palette[attr[nodeColor.name]] || DEFAULT_NODE_COLOR;\n    }\n    // Size\n    if (!nodeSize) {\n      let v = attr.size || 1;\n      renderedNode.size = nodeSizeScale(v);\n    } else {\n      let v = attr[nodeSize.name];\n      v = typeof v === 'number' ? v : 1;\n      renderedNode.size = nodeSizeScale(v);\n    }\n\n    renderedNode.size *= nodeSizeFactor;\n\n    // Label\n    if (!nodeLabel) {\n      renderedNode.label = attr.label || key;\n    } else {\n      renderedNode.label = nodeLabel === 'default' ? attr.label || key : attr[nodeLabel] || '';\n    }\n    // renderedNode.label = renderedNode.label === '' ? 'coucou': renderedNode.label;\n\n    // // hidden\n    if (filters.length && evalIfNodeMatches(attr, filters, filtersModeAnd) === false) {\n      renderedNode.hidden = true;\n      renderedNode.label = '';\n    } else {\n      renderedNode.hidden = false;\n    }\n\n    return renderedNode;\n  };\n\n  return nodeReducer;\n}\n\n\nexport function createEdgeReducer({\n  nodeColor,\n  nodeSize,\n  // nodeLabel,\n  // nodeSizeFactor = 1,\n  // extents,\n  // filters = [],\n  // filtersModeAnd,\n  edgesMap,\n  colorPalette,\n}) {\n\n  \n  // Creating actual reducer\n  const edgeReducer = function (key, attr, el1, el2) {\n    const {\n      sourceNode, \n      targetNode\n    } = edgesMap.get(key);\n    const renderedEdge = {};\n    // color with biggest node\n    const sourceNodeSize = nodeSize ? sourceNode[nodeSize.name] : sourceNode.size;\n    const targetNodeSize = nodeSize ? targetNode[nodeSize.name] : targetNode.size;\n    const biggerNode = sourceNodeSize > targetNodeSize ? sourceNode : targetNode;\n\n    // Color\n    if (biggerNode) {\n      if (!nodeColor) {\n        renderedEdge.color = biggerNode.color || DEFAULT_NODE_COLOR;\n      } else if (colorPalette) {\n        renderedEdge.color = colorPalette[biggerNode[nodeColor.name]] || DEFAULT_NODE_COLOR;\n      }  else {\n        renderedEdge.color =\n          nodeColor.palette[biggerNode[nodeColor.name]] || DEFAULT_NODE_COLOR;\n      }\n      renderedEdge.color = Color(renderedEdge.color).lighten(0.4).rgb().string();\n    }\n    return renderedEdge;\n  };\n\n  return edgeReducer;\n}","import DebouncedInput from './DebouncedInput';\n\nexport default DebouncedInput;","\n\nimport debounce from 'lodash/debounce';\nimport {useState, useEffect, useMemo} from 'react';\nimport Textarea from 'react-textarea-autosize';\n\nexport default function DebouncedInput({\n  value: propsValue,\n  onChange: propsOnChange,\n  type = 'input',\n  ...rest\n}) {\n  const [value, setValue] = useState(propsValue);\n\n  useEffect(() => {\n    setValue(propsValue);\n  }, [propsValue]);\n\n  const propagateChange = useMemo(() => debounce(propsOnChange, 300), [propsOnChange]);\n\n  const handleChange = e => {\n    setValue(e.target.value);\n    propagateChange(e.target.value);\n  }\n  if (type === 'input') {\n    return (\n      <input\n        value={value}\n        onChange={handleChange}\n        {...rest}\n      />\n    );\n  }\n  return (\n    <Textarea\n      value={value}\n      onChange={handleChange}\n      {...rest}\n    />\n  );\n}","import React, {useCallback, useRef, useState, useEffect, useMemo} from 'react';\n// import Graph from 'graphology';\nimport {WebGLRenderer} from 'sigma';\nimport {scaleLinear} from 'd3-scale';\n// import colorParse from 'parse-color';\nimport {min, max} from 'd3-array';\nimport ContainerDimensions from 'react-container-dimensions';\n\nimport {\n  usePrevious, \n} from './hooks';\nimport GraphControls from './GraphControls';\nimport {createNodeReducer, createEdgeReducer} from './reducers';\nimport {generatePalette} from '../../helpers/palettes';\nimport Input from '../DebouncedInput';\n\nimport './GraphContainer.css';\nimport { evalIfNodeMatches } from '../../helpers/misc';\n\n\n\n// Camera controls\nfunction rescale(renderer) {\n  const camera = renderer.getCamera();\n  camera.animatedReset(renderer);\n}\n\nfunction zoomIn(renderer) {\n  const camera = renderer.getCamera();\n  camera.animatedZoom(renderer);\n}\n\nfunction zoomOut(renderer) {\n  const camera = renderer.getCamera();\n  camera.animatedUnzoom(renderer);\n}\n\n\nfunction GraphContainer({\n  graph,\n  width,\n  height,\n  // nodeColor,\n  // nodeSize,\n  labelDensity,\n  displayAllLabels,\n  extents,\n\n  searchString = '',\n  onSearchStringChange,\n\n  filtersModeAnd,\n  onToggleFiltersModeAnd,\n\n  filtersOptions = {},\n  filters = [],\n  onFiltersChange,\n\n  onCameraUpdate,\n\n  cameraPosition,\n\n  updateTimestamp,\n  title,\n  legend,\n\n  nodeSizeVariable,\n  nodeColorVariable,\n  colorPalette,\n  nodeLabelVariable,\n  onNodeSizeVariableChange,\n  onNodeColorVariableChange,\n  onNodeLabelVariableChange,\n  onLabelDensityChange,\n  onColorPaletteChange,\n  onTitleChange,\n  onLegendChange,\n  onDisplayAllLabelsChange,\n}) {\n  const CELL_HEIGHT_RANGE = [height / 5, 1];\n  const CELL_WIDTH_RANGE = [width / 5, 1];\n\n  // const CELL_HEIGHT_RANGE = [200, 10];\n  // const CELL_WIDTH_RANGE = [300, 30];\n\n  const cellHeightScale = scaleLinear().domain([0, 1]).range(CELL_HEIGHT_RANGE);\n  const cellWidthScale = scaleLinear().domain([0, 1]).range(CELL_WIDTH_RANGE);\n\n\n  const nodeSize = useMemo(() => {\n    if (nodeSizeVariable && nodeSizeVariable !== 'default' && filtersOptions[nodeSizeVariable]) {\n      const values = Array.from(filtersOptions[nodeSizeVariable].options)\n      return {\n        min: min(values),\n        max: max(values),\n        name: nodeSizeVariable\n      }\n    } else return undefined;\n  }, [nodeSizeVariable])\n\n  const nodeColor = useMemo(() => {\n    if (nodeColorVariable && nodeColorVariable !== 'default' && filtersOptions[nodeColorVariable]) {\n      const colors = generatePalette(nodeColorVariable, filtersOptions[nodeColorVariable].options.size);\n      let palette = {};\n      let i = 0;\n      filtersOptions[nodeColorVariable].options.forEach(option => {\n        palette[option] = colors[i];\n        i++;\n      });\n      return {\n        palette,\n        name: nodeColorVariable\n      }\n    } else return undefined;\n  }, [nodeColorVariable])\n\n  const edgesMap = useMemo(() => {\n    const m = new Map()\n    graph.forEach(\n      (_source, _target, sourceAttributes, targetAttributes, edge, _edgeAttributes) => {\n      m.set(edge, {sourceNode: sourceAttributes, targetNode: targetAttributes})\n    });\n    return m;\n  }, [graph])\n\n  const previousNodeColor = usePrevious(nodeColor);\n  const previousNodeSize = usePrevious(nodeSize);\n  const previousNodeLabelVariable = usePrevious(nodeLabelVariable);\n  const previousLabelDensity = usePrevious(labelDensity);\n  const previousSearchString = usePrevious(searchString);\n  const previousFilters = usePrevious(filters);\n  const previousColorPalette = usePrevious(colorPalette);\n  const previousFiltersModeAnd = usePrevious(filtersModeAnd);\n  const previousDisplayAllLabels = usePrevious(displayAllLabels);\n\n  const nodeReducer = createNodeReducer({\n    nodeColor,\n    nodeSize,\n    nodeLabel: nodeLabelVariable,\n    extents,\n    filters,\n    filtersModeAnd,\n    colorPalette,\n  });\n  \n  const edgeReducer = createEdgeReducer({\n    nodeColor,\n    colorPalette,\n    // nodeSize,\n    // nodeLabel,\n    // extents,\n    filters,\n    filtersModeAnd,\n    edgesMap,\n  });\n\n  const container = useRef(null);\n  const [renderer, setRenderer] = useState(null);\n\n\n  useEffect(() => {\n    if (cameraPosition && renderer) {\n        const camera = renderer.getCamera();\n        // console.log('animate camera', camera);\n        camera.animate(cameraPosition);     \n    }  \n  }, [updateTimestamp])\n\n  // Should we refresh?\n  if (renderer) {\n    let needToRefresh = false;\n\n    if (\n      previousNodeColor !== nodeColor ||\n      previousNodeSize !== nodeSize ||\n      previousNodeLabelVariable !== nodeLabelVariable ||\n      previousColorPalette !== colorPalette ||\n      // previousSearchString !== searchString ||\n      JSON.stringify(previousFilters) !== JSON.stringify(filters) ||\n      previousFiltersModeAnd !== filtersModeAnd\n    ) {\n      // console.log('Refreshing sigma');\n\n      // TODO: use upcoming #.setNodeReducer\n      renderer.settings.nodeReducer = nodeReducer;\n      renderer.settings.edgeReducer = edgeReducer;\n      needToRefresh = true;\n    }\n\n    if (previousLabelDensity !== labelDensity) {\n      let actualLabelDensity = labelDensity > 1 ? 1 : labelDensity;\n      const cellWidth = cellWidthScale(actualLabelDensity);\n      const cellHeight = cellHeightScale(actualLabelDensity);\n      renderer.settings.labelGrid.cell = {\n        width: cellWidth,\n        height: cellHeight\n      };\n\n      // TODO from nansi: we can improve sigma to handle this\n      renderer.displayedLabels = new Set();\n      needToRefresh = true;\n    }\n\n    // workaround for clusters titles display\n    // @todo replace this with a cleaner solution at some point\n    if ((\n      previousDisplayAllLabels !== displayAllLabels || !previousDisplayAllLabels || renderer.displayedLabels.size === 0\n      || previousNodeLabelVariable !== nodeLabelVariable || JSON.stringify(previousFilters) !== JSON.stringify(filters)\n      ) && displayAllLabels) {\n      graph.forEachNode((id, attributes) => {\n        const {label} = attributes;\n        \n        const displayedLabel = nodeLabelVariable && nodeLabelVariable !== 'default' ? attributes[nodeLabelVariable] : label;\n        if (evalIfNodeMatches(attributes, filters, filtersModeAnd) && displayedLabel && displayedLabel.trim().length > 0) {\n          renderer.highlightNode(id)\n        } else {\n          renderer.unhighlightNode(id);\n        }\n      })\n      needToRefresh = true;\n    } else if (previousDisplayAllLabels !== displayAllLabels && !displayAllLabels) {\n      renderer.highlightedNodes = new Set();\n      needToRefresh = true;\n    }\n\n    if (previousSearchString !== searchString) {\n      if (searchString.length >= 3) {\n        graph.forEachNode((id, attributes) => {\n          const {label} = attributes;\n          if (label.toLowerCase().includes(searchString.toLowerCase())) {\n            renderer.highlightNode(id)\n          } else renderer.unhighlightNode(id)\n        })\n      } else if (renderer.highlightedNodes.size > 0) {\n        renderer.highlightedNodes = new Set();\n      }\n      needToRefresh = true;\n    }\n\n    if (needToRefresh) {\n      renderer.refresh();\n    }\n  }\n\n  const setContainer = useCallback(\n    node => {\n      if (renderer && renderer.graph !== graph) {\n        renderer.kill();\n        setRenderer(null);\n      }\n\n      if (node && graph) {\n       \n        const newRenderer = new WebGLRenderer(graph, node, {nodeReducer, edgeReducer});\n        let actualLabelDensity = labelDensity > 1 ? 1 : labelDensity;\n        const cellWidth = cellWidthScale(actualLabelDensity);\n        const cellHeight = cellHeightScale(actualLabelDensity);\n        newRenderer.settings.labelGrid.cell = {\n          width: cellWidth,\n          height: cellHeight\n        };\n        newRenderer.displayedLabels = new Set();\n        newRenderer.refresh();\n        setRenderer(newRenderer);\n        const camera = newRenderer.getCamera();\n        onCameraUpdate(camera.getState())\n        camera.on('updated', state => {\n          onCameraUpdate(state);\n        })\n      }\n\n      container.current = node;\n    },\n    [graph] /* eslint react-hooks/exhaustive-deps : 0 */\n  );\n  return (\n    <>\n\n      <div ref={setContainer} style={{width: '100%', height: '100%'}}></div>\n      {renderer && (\n        <>\n          <GraphControls\n            rescale={rescale.bind(null, renderer)}\n            zoomIn={zoomIn.bind(null, renderer)}\n            zoomOut={zoomOut.bind(null, renderer)}\n            {\n              ...{\n                searchString,\n                onSearchStringChange,\n                filtersModeAnd,\n                onToggleFiltersModeAnd,\n                filtersOptions,\n                filters,\n                onFiltersChange,\n                nodeSizeVariable,\n                nodeColorVariable,\n                nodeLabelVariable,\n                labelDensity,\n                displayAllLabels,\n                onNodeSizeVariableChange,\n                onNodeColorVariableChange,\n                onNodeLabelVariableChange,\n                onColorPaletteChange,\n                onLabelDensityChange,\n                onDisplayAllLabelsChange,\n                colorPalette: colorPalette,\n              }\n            }\n          />\n          <form onSubmit={e => {e.preventDefault()}} className=\"caption-editor-container\">\n            <h1 className=\"caption-title-container\">\n              <Input\n                value={title || ''}\n                onChange={val => onTitleChange(val)}\n                placeholder=\"Titre de la visualisation\"\n              />\n            </h1>\n            <div className=\"caption-legend-container\">\n              <Input\n                value={legend || ''}\n                type=\"textarea\"\n                onChange={val => onLegendChange(val)}\n                placeholder=\"Légende de la visualisation\"\n              />\n            </div>\n          </form>\n        </>\n      )}\n    </>\n  );\n}\n\nexport default function GraphContainerWithDimensions(props) {\n  return (\n    <div className=\"VisContainer GraphContainer\">\n\n    <ContainerDimensions>\n      {\n        dimensions => <GraphContainer {...{...props, ...dimensions}} />\n      }\n    </ContainerDimensions>\n    </div>\n  )\n}","import React, {useContext} from 'react';\nimport { Link } from 'react-router-dom';\nimport {LanguageContext} from '../../contexts';\nimport cx from 'classnames';\n\nconst FooterNav = ({\n  prevPage,\n  nextPage\n}) => {\n  const {\n    lang\n  } = useContext(LanguageContext);\n  const messages = {\n    next: {\n      fr: 'Page suivante',\n      en: 'Next page'\n    },\n    prev: {\n      fr: 'Page précédente',\n      en: 'Previous page'\n    }\n  }\n  return (\n    <footer className={cx(\"FooterNav\", {'start-page': !prevPage})}>\n      <ul>\n        {\n          prevPage ?\n            <li className=\"previous-page\">\n              <h5>\n                <Link to={prevPage.route[lang]}>\n                  <div className=\"marker\">{'<'}</div>\n                  <div className=\"page-content\">\n                    <div className=\"page-label\"><i>{messages.prev[lang]}</i></div>\n                    <div>\n                        {prevPage.title[lang]}\n                    </div>\n                  </div>\n                </Link>\n              </h5>\n            </li>\n            :\n            null\n        }\n        {\n          nextPage ?\n            <li className=\"next-page\">\n              <h5>\n                <Link to={nextPage.route[lang]}>\n                  <div>\n                    <div className=\"page-label\"><i>{messages.next[lang]}</i></div>\n                    <div className=\"page-content\">\n                        {nextPage.title[lang]}\n                    </div>\n                  </div>\n                  <div className=\"marker\">{'>'}</div>\n                </Link>\n              </h5>\n            </li>\n            :\n            null\n        }\n      </ul>\n    </footer>\n  )\n}\n\nexport default FooterNav;","import FooterNav from './FooterNav';\n\nexport default FooterNav;","import React, {useState, useMemo, useEffect, Suspense} from 'react';\nimport {extent} from 'd3-array';\nimport {generatePalette} from '../../helpers/palettes';\n\n\nimport gexf from 'graphology-gexf';\nimport Graph from 'graphology';\n\nimport GraphVis from './GraphContainer';\nimport FooterNav from '../FooterNav';\n// import CodeContainer from '../../components/CodeContainer';\nimport {computeFiltersOptions} from '../../helpers/misc';\n\nimport {VisualizationControlContext} from '../../contexts';\n\nconst DEFAULT_LABEL_DENSITY = 0.25;\n\nconst Loader = ({percentsLoaded = 0}) =>{\n  return  (\n    <div className=\"loader-container\">\n      <div className=\"loader\">\n        <div className=\"loading-bar\" style={{width: percentsLoaded + '%'}} />\n      </div>\n   </div>\n)\n}\n\nconst GraphAnnotation = ({\n  Content,\n  data,\n  contentsURL,\n  prevPage,\n  nextPage,\n}) => {\n  const graph = useMemo(() => {\n    return gexf.parse(Graph, data);\n  }, [data]);\n  const filtersOptions = useMemo(() => computeFiltersOptions('graph', graph, data), [graph, data]);\n\n  const [cameraPosition, setCameraPosition] = useState(undefined);\n  const [helpVisible, setHelpVisible] = useState(false);\n  const [searchString, setSearchString] = useState('');\n  const [filtersModeAnd, setFiltersModeAnd] = useState(false);\n  const [updateTimestamp, setUpdateTimeStamp] = useState(new Date().getTime());\n  const [filters, setFilters] = useState([]);\n  const [nodeColorVariable, setNodeColorVariable] = useState(undefined);\n  const [colorPalette, setColorPalette] = useState(undefined);\n  const [nodeSizeVariable, setNodeSizeVariable] = useState(undefined);\n  const [nodeLabelVariable, setNodeLabelVariable] = useState(undefined);\n  const [labelDensity, setLabelDensity] = useState(DEFAULT_LABEL_DENSITY);\n  const [title, setTitle] = useState('');\n  const [legend, setLegend] = useState('');\n  const [displayAllLabels, setDisplayAllLabels] = useState(false);\n  const [hasLoadedFirstVis, setHasLoadedFirstVis] = useState(false);\n\n  const [focusedVisualizationId, setFocusedVisualizationId] = useState(null);\n  const [registeredVisualizations, setRegisteredVisualizations] = useState({});\n\n  const onRegisterVisualization = (id, props) => {\n    setRegisteredVisualizations({\n      ...registeredVisualizations,\n      [id]: props\n    })\n  }\n\n  const onUnregisterVisualization = id => {\n    const copyOfRegistered = {...registeredVisualizations};\n    delete copyOfRegistered[id]\n    setRegisteredVisualizations(copyOfRegistered)\n  }\n\n  const onVisualizationUpdate = ({\n    x, \n    y, \n    ratio, \n    searchString: newSearchString, \n    filtersModeAnd: newFiltersModeAnd, \n    filters: newFilters, \n    nodeColorVariable: newNodeColorVariable,\n    nodeSizeVariable,\n    nodeLabelVariable,\n    labelDensity,\n    colorPalette: newColorPalette,\n    title: newTitle,\n    legend: newLegend,\n    displayAllLabels: newDisplayAllLabels\n}) => {\n    setCameraPosition({x, y, ratio});\n    setUpdateTimeStamp(new Date().getTime());\n    setSearchString(newSearchString);\n    setFiltersModeAnd(newFiltersModeAnd);\n    setFilters(newFilters);\n    setNodeColorVariable(newNodeColorVariable);\n    setNodeSizeVariable(nodeSizeVariable);\n    setNodeLabelVariable(nodeLabelVariable);\n    setDisplayAllLabels(newDisplayAllLabels);\n    setTitle(newTitle);\n    setLegend(newLegend);\n    if (newColorPalette && (nodeColorVariable === newNodeColorVariable || !nodeColorVariable)) {\n      setColorPalette(newColorPalette);\n    } else {\n      const colors = generatePalette(newNodeColorVariable, filtersOptions[newNodeColorVariable].options.size);\n      const palette = {};\n      let i = 0;\n      filtersOptions[newNodeColorVariable].options.forEach(option => {\n        palette[option] = colors[i];\n        i++;\n      });\n      setColorPalette(palette);\n    }\n    setLabelDensity(labelDensity === undefined ? DEFAULT_LABEL_DENSITY : labelDensity);\n  }\n\n  useEffect(() => {\n    if (!focusedVisualizationId && Object.keys(registeredVisualizations).length) {\n      const thatId = Object.keys(registeredVisualizations)[0];\n      setFocusedVisualizationId(thatId );\n      onVisualizationUpdate(registeredVisualizations[thatId]);\n      setHasLoadedFirstVis(true);\n    }\n  }, [registeredVisualizations, focusedVisualizationId]);/* eslint react-hooks/exhaustive-deps : 0 */\n\n  let sizes = [];\n  graph.forEachNode((node, attributes) => {\n    sizes.push(attributes.size);\n  })\n  const sizeExtent = extent(sizes);\n\n  const onCameraUpdate = state => {\n    const {x, y, ratio} = state;\n    setCameraPosition({x, y, ratio});\n  }\n  \n  const onSearchStringChange = str => {\n    setSearchString(str);\n  }\n  return (\n    <VisualizationControlContext.Provider value={{\n      onVisualizationUpdate, \n      onRegisterVisualization, \n      onUnregisterVisualization, \n      focusedVisualizationId,\n      setFocusedVisualizationId,\n      visualizationParams: {\n        ...cameraPosition,\n        searchString,\n        // filtersOptions,\n        filters,\n        // updateTimestamp,\n        displayAllLabels,\n        nodeSizeVariable,\n        nodeColorVariable,\n        nodeLabelVariable,\n        filtersModeAnd,\n        labelDensity,\n        colorPalette,\n        title,\n        legend,\n      }\n    }}>\n    <div className=\"slide-container\">\n      <section>\n        <div>\n          <p>\n            <button className={helpVisible ? 'is-active': ''} onClick={() => setHelpVisible(!helpVisible)}>\n              Comment modifier cette page ?\n            </button>\n          </p>\n          <ol className={`edit-help ${helpVisible ? 'is-active' : ''}`}>\n            <li>\n              Préalablement se logger dans github si le répertoire est privé\n            </li>\n            <li>\n              Se rendre sur <a target=\"blank\" href={contentsURL}>cette page du répertoire github</a>\n            </li>\n            <li>\n              Cliquer sur le crayon en haut à droite des contenus (il affiche \"edit\" au survol)\n            </li>\n            <li>\n              Faire les modifications puis cliquer sur \"Commit changes\" en bas de la page\n            </li>\n            <li>\n              Attendre 2 minutes puis recharger la page pour voir la version à jour de la page\n            </li>\n          </ol>\n        </div>\n        <Suspense fallback={<div>Chargement</div>}>\n          <Content />\n        </Suspense>\n        <FooterNav prevPage={prevPage} nextPage={nextPage} />\n      </section>\n      \n      <aside>\n        {hasLoadedFirstVis ?\n        <div className=\"vis\">\n          <GraphVis\n            {\n              ...{\n                graph,\n                // nodeColor,\n                // nodeSize,\n                // nodeLabel,\n                // labelDensity,\n                searchString,\n                filtersOptions,\n                filters,\n                cameraPosition,\n                onCameraUpdate,\n                updateTimestamp,\n                nodeSizeVariable,\n                nodeColorVariable,\n                nodeLabelVariable,\n                filtersModeAnd,\n                labelDensity,\n                displayAllLabels,\n                title,\n                legend,\n\n                colorPalette,\n\n                onSearchStringChange,\n                onToggleFiltersModeAnd: () => setFiltersModeAnd(!filtersModeAnd),\n\n                onFiltersChange: (newFilters) => setFilters(newFilters),\n\n                onLabelDensityChange: val => setLabelDensity(val),\n                onDisplayAllLabelsChange: val => setDisplayAllLabels(val),\n                onNodeSizeVariableChange: (val) => setNodeSizeVariable(val),\n                onNodeColorVariableChange: (val) => setNodeColorVariable(val),\n                onNodeLabelVariableChange: (val) => setNodeLabelVariable(val),\n                onColorPaletteChange: val => setColorPalette(val),\n                onTitleChange: val => setTitle(val),\n                onLegendChange: val => setLegend(val),\n\n                extents: {\n                  nodeSize: {\n                    min: sizeExtent[0],\n                    max: sizeExtent[1]\n                  }\n                }\n              }\n            }\n          />\n          \n        </div>\n        : <Loader percentsLoaded={50} /> }\n        {/* <CodeContainer code={currentCode} /> */}\n      </aside>\n  </div>\n  </VisualizationControlContext.Provider>\n  )\n}\n\nexport default GraphAnnotation;","import GraphAnnotation from './GraphAnnotation';\n\nexport default GraphAnnotation;","import React, {useState} from 'react';\nimport cx from 'classnames';\n\nimport VariablesEditor from '../VariablesEditor';\nimport ColorLegend from '../ColorLegend';\nimport FiltersEditor from '../FiltersEditor';\n\nexport default function IceCreamControls({\n  xVariable,\n  reverseX,\n\n  yVariable,\n  reverseY,\n\n  sizeVariable,\n  colorVariable,\n  labelVariable,\n  labelsOnTheSide,\n  colorScaleType,\n\n  onToggleFiltersModeAnd,\n  filtersModeAnd,\n  onFiltersChange,\n  filters,\n\n  rotateMode,\n  searchString,\n\n  onSearchStringChange,\n  onToggleRotateMode,\n  \n  onXVariableChange,\n  onYVariableChange,\n  onColorVariableChange,\n  onSizeVariableChange,\n  onLabelVariableChange,\n  onToggleLabelsOnTheSide,\n  onColorPaletteChange,\n\n  onToggleReverseX,\n  onToggleReverseY,\n  onColorScaleTypeChange,\n  \n  filtersOptions,\n  colorPalette,\n}) {\n  const handleSearchChange = e => onSearchStringChange(e.target.value);\n  const [isMinified, setIsMinified] = useState(true)\n  return (\n    <>\n      <button onClick={() => setIsMinified(!isMinified)} className={cx('minify-button', {'is-active': !isMinified})}>\n        {'éditer'}\n      </button>\n      <ul className={cx(\"VisControls\", {'is-minified': isMinified})}>\n        \n        <li className=\"vis-controls-item\">\n        <form onSubmit={e => e.preventDefault()}>\n          <input type=\"text\" onChange={handleSearchChange} placeholder=\"rechercher\" value={searchString} />\n        </form>\n        </li>\n        <li className=\"vis-controls-item\">\n          <VariablesEditor\n            {\n              ...{\n                options: filtersOptions,\n                variables: [\n                  {\n                    title: 'X des points',\n                    onChange: onXVariableChange,\n                    value: xVariable,\n                    type: 'number'\n                  },\n                  {\n                    title: 'Inverser les x',\n                    onChange: onToggleReverseX,\n                    value: reverseX,\n                    type: 'boolean'\n                  },\n                  {\n                    title: 'Y des points',\n                    onChange: onYVariableChange,\n                    value: yVariable,\n                    type: 'number'\n                  },\n                  {\n                    title: 'Inverser les y',\n                    onChange: onToggleReverseY,\n                    value: reverseY,\n                    type: 'boolean'\n                  },\n                  {\n                    title: 'Taille des points',\n                    onChange: onSizeVariableChange,\n                    value: sizeVariable,\n                    type: 'number'\n                  },\n                  {\n                    title: 'Couleur des points',\n                    onChange: onColorVariableChange,\n                    value: colorVariable,\n                    type: 'color'\n                  },\n                  {\n                    title: 'Type d\\'échelle pour la couleur',\n                    onChange: onColorScaleTypeChange,\n                    localOptions: [[\n                      'discrete',\n                      {title: 'discrète'}\n                    ], [\n                      'continuous',\n                      {title: 'continue'}\n                    ]],\n                    value: colorScaleType,\n                    type: 'string'\n                  },\n                  {\n                    title: 'Labels des points',\n                    onChange: onLabelVariableChange,\n                    value: labelVariable,\n                    type: 'string'\n                  },\n                  {\n                    title: 'Tourner la visualisation à 45°',\n                    onChange: onToggleRotateMode,\n                    value: rotateMode,\n                    type: 'boolean'\n                  },\n                  {\n                    title: 'Afficher les labels sur le côté',\n                    onChange: onToggleLabelsOnTheSide,\n                    value: labelsOnTheSide,\n                    type: 'boolean'\n                  },\n                  \n                ],\n              }\n            }\n          />\n        </li>\n        <li className=\"vis-controls-item\">\n          <FiltersEditor\n            {\n              ...{\n                onToggleFiltersModeAnd,\n                filtersModeAnd,\n                filtersOptions,\n                onFiltersChange,\n                filters\n              }\n            }\n          />\n        </li>\n        {\n            colorVariable && colorVariable !== 'default' ?\n            <ColorLegend\n              colorPalette={colorPalette}\n              onChange={onColorPaletteChange}\n            />\n            : null\n        }\n      </ul>\n    </>\n  );\n}","import React, {useState, useEffect} from 'react';\nimport ContainerDimensions from 'react-container-dimensions';\nimport {scaleLinear} from 'd3-scale';\nimport {min, extent} from 'd3-array';\nimport cx from 'classnames';\n\nimport IceCreamControls from './IceCreamControls';\nimport {generatePalette} from '../../helpers/palettes';\nimport Input from '../DebouncedInput';\n\nimport './IceCreamContainer.css';\nimport { evalIfNodeMatches, transformGeometry } from '../../helpers/misc';\n\nconst GIF_TIME = 500;\n\nfunction IceCreamContainer({\n\n  width, \n  height,\n  data,\n\n  xVariable,\n  reverseX,\n  yVariable,\n  reverseY,\n  sizeVariable,\n  colorVariable,\n  labelVariable,\n  labelsOnTheSide = true,\n  colorPalette: inputColorPalette,\n  colorScaleType,\n\n  rotateMode,\n  searchString = '',\n\n  onSearchStringChange,\n  onToggleRotateMode,\n  filtersOptions = {},\n\n  onToggleFiltersModeAnd,\n  filtersModeAnd,\n  onFiltersChange,\n  filters,\n  title,\n  legend,\n\n  \n  onXVariableChange,\n  onYVariableChange,\n  onColorVariableChange,\n  onSizeVariableChange,\n  onLabelVariableChange,\n  onToggleReverseX,\n  onToggleReverseY,\n  onToggleLabelsOnTheSide,\n  onColorPaletteChange,\n  onColorScaleTypeChange,\n  onTitleChange,\n  onLegendChange,\n}) {\n\n  const [zoomedIndex, setZoomedIndex] = useState(null);\n  const [enableZoom, setEnableZoom] = useState(true);\n\n  const updateActive = () => {\n    if (filters && filters.length) {\n      const existing = zoomedIndex === null ? -1 : zoomedIndex;\n      let found = false;\n      for (let i = existing + 1 ; i < data.length ; i++) {\n        if (evalIfNodeMatches(data[i], filters, filtersModeAnd)) {\n          setZoomedIndex(i);\n          found = true;\n          break;\n        }\n      }\n      if (!found) {\n        for (let i = 0 ; i < data.length ; i++) {\n          if (evalIfNodeMatches(data[i], filters, filtersModeAnd)) {\n            setZoomedIndex(i);\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  useEffect(() => {\n    if (filters && filters.length) {\n      if (zoomedIndex === null) {\n        updateActive();\n      }\n      setTimeout(updateActive, GIF_TIME);\n    } else {\n      setZoomedIndex(null);\n    }\n  /* eslint react-hooks/exhaustive-deps : 0 */\n  }, [\n    filters,\n    filtersModeAnd,\n    data,\n    zoomedIndex\n  ])\n \n  const smallestDimension = min([width, height]);\n  // in rotate mode width indexed on the hypothenuse\n  const WIDTH = rotateMode ? parseInt(Math.sqrt(smallestDimension * smallestDimension / 2)) : smallestDimension;\n  const HEIGHT = rotateMode ? parseInt(Math.sqrt(smallestDimension * smallestDimension / 2)) : smallestDimension;\n\n  const MIN_AREA = smallestDimension / 50;\n  const MAX_AREA = smallestDimension / 2;\n  const MARGIN = WIDTH / 15;\n\n  let xRange = [MARGIN, WIDTH - MARGIN * 2];\n  let yRange = [MARGIN, HEIGHT - MARGIN * 2];\n  if (reverseX) {\n    xRange = xRange.reverse();\n  }\n  if (reverseY) {\n    yRange = yRange.reverse();\n  }\n\n  const getX = xVariable && xVariable !== 'default' ?  scaleLinear().range(xRange).domain([0, 1]) : () => 0;\n  const getY = yVariable && yVariable !== 'default' ?  scaleLinear().range(yRange).domain([0, 1]) : () => 0;\n  const getSize = sizeVariable && sizeVariable !== 'default' ?  scaleLinear().domain(extent(data.map(d => +d[sizeVariable]))).range([MIN_AREA, MAX_AREA]) : () => 0;\n\n  // manage palette\n  let colorPalette;\n  if (inputColorPalette) {\n    colorPalette = inputColorPalette;\n  }\n  else if (colorVariable && colorVariable !== 'default' && filtersOptions[colorVariable]) {\n    const palette = generatePalette(colorVariable, filtersOptions[colorVariable].options.length);\n    colorPalette = filtersOptions[colorVariable].options.reduce((res, option, index) => ({\n      ...res,\n      [option]: palette[index]\n    }), {})\n  }\n  let continuousColorScale;\n  if (colorScaleType === 'continuous') {\n    let colorRange = ['#D77186', '#61A2DA'];\n    if (colorPalette && colorPalette['from'] && colorPalette['to']) {\n      colorRange = [colorPalette['from'], colorPalette['to']]\n    } else {\n      colorPalette = {\n        from: '#D77186',\n        to: '#61A2DA'\n      }\n    }\n    continuousColorScale = scaleLinear().domain(extent(data.map(d => +d[colorVariable]))).range(colorRange)\n  }\n  let getColor = (val) => {\n    if (colorScaleType === 'continuous') {\n      return continuousColorScale(+val);\n    } else return colorPalette ? colorPalette[val] : 'grey';\n  }\n\n  // handling search\n  let highlightedIndex;\n  if (searchString.length && labelVariable) {\n    highlightedIndex = new Set();\n    data.forEach((datum, index) => {\n      const label = datum[labelVariable].toLowerCase();\n      if (label.includes(searchString)) {\n        highlightedIndex.add(index);\n      }\n    })\n  }\n  let rotateTransform = {rotate: 0};\n  if (rotateMode) {\n    rotateTransform = {\n      rotate: -45,\n      translate: {x: 0, y: smallestDimension/2}\n    }\n  }\n  // wrapping function for transforms\n  const transf = (x, y) => transformGeometry({x, y}, rotateTransform)\n  // dimensions of control background rect\n  const {x: point1X, y: point1Y} = transformGeometry({\n    x: 0,\n    y: 0\n  }, rotateTransform)\n  const {x: point2X, y: point2Y} = transformGeometry({\n    x: WIDTH,\n    y: 0\n  }, rotateTransform)\n  const {x: point3X, y: point3Y} = transformGeometry({\n    x: WIDTH,\n    y: HEIGHT\n  }, rotateTransform)\n  const {x: point4X, y: point4Y} = transformGeometry({\n    x: 0,\n    y: HEIGHT\n  }, rotateTransform)\n  \n  return (\n    <>\n        <svg \n          className={cx(\"scatterplot\", {'zoom-mode': zoomedIndex !== null && enableZoom})}\n          width={smallestDimension} \n          height={smallestDimension}\n          transform={`translate(${(width - smallestDimension) / 2}, 0)`}\n        >\n          <polygon \n            points={`${point1X},${point1Y} ${point2X},${point2Y} ${point3X},${point3Y} ${point4X},${point4Y}`} \n            width={WIDTH} \n            height={HEIGHT} \n            fill=\"white\" \n          />\n          <g transform={`translate(${rotateMode ? 0 : MARGIN / 2}, ${rotateMode ? -MARGIN : 0})${rotateMode ? 'scale(1.05)' : ''}`}>\n            <g className=\"axis axis-left\">\n              <line \n                x1={transf(MARGIN, MARGIN).x}\n                y1={transf(MARGIN, MARGIN).y}\n                x2={transf(MARGIN, HEIGHT - MARGIN * 2).x}\n                y2={transf(MARGIN, HEIGHT - MARGIN * 2).y}\n                stroke={'black'} \n              />\n              {\n                getY.ticks &&\n                getY.ticks()\n                .map(tick => {\n   \n                  const {x, y} = transf(MARGIN, getY(tick))\n                  const {x: x1, y: y1} = transf(MARGIN/4, getY(tick) + MARGIN/6)\n                  const {x: x2, y: y2} = transf(MARGIN/2, getY(tick))\n                  return (\n                    <g key={tick}>\n                      <text textAnchor=\"end\" x={x1} y={y1}>\n                        {tick}\n                      </text>\n                      <line\n                        x1={x}\n                        y1={y}\n                        x2={x2}\n                        y2={y2}\n                        stroke={'black'}\n                      />\n                    </g>\n                  )\n                })\n              }\n              <g\n                transform={rotateMode ? `translate(${WIDTH/2 - MARGIN * 1.5}, ${HEIGHT + MARGIN * 2.5})rotate(45)` : `translate(0, ${MARGIN / 2 - 2})`}\n              >\n                <text \n                  className=\"axis-variable-name\" \n                  textAnchor={rotateMode ? 'end' : 'start'}\n                >\n                  {yVariable}\n                </text>\n              </g>\n            </g>\n            <g className=\"axis axis-bottom\">\n              <line \n                x1={transf(MARGIN, HEIGHT - MARGIN * 2).x} \n                y1={transf(MARGIN, HEIGHT - MARGIN * 2).y} \n                x2={transf(WIDTH - MARGIN * 2, HEIGHT - MARGIN * 2).x} \n                y2={transf(WIDTH - MARGIN * 2, HEIGHT - MARGIN * 2).y} \n                stroke={'black'} \n              />\n              {\n                getX.ticks &&\n                getX.ticks()\n                .map(tick => {\n                  const {x, y} = transf(getX(tick), HEIGHT - MARGIN * 2);\n                  const {x: x1, y: y1} = transf(getX(tick), HEIGHT - MARGIN * 1.66);\n                  const {x: x2, y: y2} = transf(getX(tick), HEIGHT - MARGIN * 1.25);\n                  return (\n                    <g key={tick}>\n                      <text textAnchor=\"center\" x={x2} y={y2}>\n                        {tick}\n                      </text>\n                      <line\n                        x1={x}\n                        y1={y}\n                        x2={x1}\n                        y2={y1}\n                        stroke={'black'}\n                      />\n                    </g>\n                  )\n                })\n              }\n              <g\n                transform={rotateMode ? `translate(${WIDTH}, ${HEIGHT + MARGIN * 1.5})rotate(-45)` : `translate(${WIDTH - MARGIN * 1.5}, ${HEIGHT - MARGIN / 3 - 2})`}\n              >\n                <text \n                  className=\"axis-variable-name\" \n                  textAnchor={rotateMode ? 'end' : 'start'}\n                >\n                  {xVariable}\n                </text>\n              </g>\n            </g>\n            <g className={\"ticks-container\"}>\n              {\n                \n                  getY.ticks &&\n                  getY.ticks()\n                  .map(tick => (\n                    <line \n                      key={tick}\n                      x1={transf(MARGIN, getY(tick)).x}\n                      y1={transf(MARGIN, getY(tick)).y}\n                      x2={transf(WIDTH - MARGIN * 2, getY(tick)).x}\n                      y2={transf(WIDTH - MARGIN * 2, getY(tick)).y}\n                      stroke=\"lightgrey\"\n                    />\n                  ))\n              }\n              {\n                \n                getX.ticks &&\n                getX.ticks()\n                .map(tick => (\n                  <line \n                    key={tick}\n                    x1={transf(getX(tick), MARGIN).x}\n                    y1={transf(getX(tick), MARGIN).y}\n                    x2={transf(getX(tick), WIDTH - MARGIN * 2).x}\n                    y2={transf(getX(tick), WIDTH - MARGIN * 2).y}\n                    stroke=\"lightgrey\"\n                  />\n                ))\n            }\n            </g>\n            <g \n              className=\"plot-objects-container\"\n              onMouseEnter={() => setEnableZoom(false)}\n              onMouseLeave={() => setEnableZoom(true)}\n            >\n            {\n              data\n              .sort((a, b) => {\n                if (getY(a[yVariable]) > getY(b[yVariable])) {\n                  return 1;\n                }\n                return -1;\n              })\n              .map((datum, index) => {\n                const radius = Math.sqrt(getSize(datum[sizeVariable]) / Math.PI);\n                let {x, y} = transf(getX(datum[xVariable]), getY(datum[yVariable]));\n\n                let {x: xForXAxis, y: yForXAxis} = transf(getX(datum[xVariable]), getY.range ? getY.range()[0] : 0);\n                let {x: xForYAxis, y: yForYAxis} = transf(getX.range ? getX.range()[0] : 0, getY(datum[yVariable]));\n                let labelX =  x + radius + smallestDimension / 100;\n                let labelY = rotateMode ? y - smallestDimension / 200 : y + smallestDimension / 200;\n                let pointerStartCoords = transf(getX(datum[xVariable]) + radius, getY(datum[yVariable]));\n                if (labelsOnTheSide) {\n                  let {x: newX, y: newY} = transf( WIDTH - MARGIN * 1.7, MARGIN + index * (HEIGHT - MARGIN * 3) / data.length);\n                  labelX = newX;\n                  labelY = newY;\n                }\n\n                let opacity =  1;\n                const isMatching = !filters.length || evalIfNodeMatches(datum, filters, filtersModeAnd);\n                if (filters.length) {\n                  if (isMatching && (!highlightedIndex || highlightedIndex.has(index))) {\n                    opacity = 1;\n                  } else {\n                    opacity = .05;\n                  }\n                } else if (highlightedIndex && !highlightedIndex.has(index)) {\n                  opacity = .2;\n                }\n\n                const isZoomed = index === zoomedIndex && enableZoom === true;\n           \n                return (\n                  <g \n                    key={index} \n                    className={cx(\"plot-object\", {'is-matching': isMatching, 'is-zoomed': isZoomed})}\n                    opacity={opacity}\n                  >\n                    <line\n                      className=\"axis-line\"\n                      stroke=\"grey\"\n                      strokeDasharray='1,1'\n                      x1={x}\n                      y1={y}\n                      x2={xForYAxis}\n                      y2={yForYAxis}\n                    />\n                    <line\n                      className=\"axis-line\"\n                      stroke=\"grey\"\n                      strokeDasharray='1,1'\n                      x1={x}\n                      y1={y}\n                      x2={xForXAxis}\n                      y2={yForXAxis}\n                    />\n                    <circle \n                      cx={x}\n                      cy={y}\n                      r={radius} \n                      fill={getColor(datum[colorVariable])} \n                      opacity={.8}\n                    />\n                    {\n                      labelsOnTheSide ?\n                      <line\n                        x1={pointerStartCoords.x}\n                        y1={pointerStartCoords.y}\n                        x2={labelX}\n                        y2={labelY}\n                        stroke=\"lightgrey\"\n                        strokeDasharray='4,4'\n                      />\n                      : null\n                    }\n                    <g \n                      transform={`translate(${labelX}, ${labelY})`}\n                    >\n                      <text\n                        transform={rotateMode ? 'rotate(-45)': ''}\n                        style={{\n                          fontSize: rotateMode && labelsOnTheSide ? HEIGHT / 70 : undefined\n                        }}\n                      >\n                        {datum[labelVariable]}\n                      </text>\n                    </g>\n                  </g>\n                )\n              })\n            }\n            </g>\n          </g>\n        </svg>\n        <IceCreamControls\n          {\n            ...{\n              xVariable,\n              yVariable,\n              reverseX,\n              reverseY,\n              sizeVariable,\n              colorVariable,\n              labelVariable,\n              labelsOnTheSide,\n\n              rotateMode,\n              searchString,\n              colorScaleType,\n\n              onSearchStringChange,\n              onToggleRotateMode,\n              \n              onXVariableChange,\n              onYVariableChange,\n              onColorVariableChange,\n              onSizeVariableChange,\n              onLabelVariableChange,\n              onToggleLabelsOnTheSide,\n              onToggleReverseX,\n              onToggleReverseY,\n              onColorPaletteChange,\n              onColorScaleTypeChange,\n\n              onToggleFiltersModeAnd,\n              filtersModeAnd,\n              onFiltersChange,\n              filters,\n\n              filtersOptions,\n              colorPalette,\n            }\n          }\n        />\n        <form onSubmit={e => {e.preventDefault()}} className=\"caption-editor-container\">\n            <h1 className=\"caption-title-container\">\n              <Input\n                value={title || ''}\n                onChange={val => onTitleChange(val)}\n                placeholder=\"Titre de la visualisation\"\n              />\n            </h1>\n            <div className=\"caption-legend-container\">\n              <Input\n                value={legend || ''}\n                onChange={val => onLegendChange(val)}\n                placeholder=\"Légende de la visualisation\"\n                type=\"textarea\"\n              />\n            </div>\n          </form>\n    </>\n  );\n}\n\nexport default function IceCreamContainerWithDimensions(props) {\n  return (\n    <div className=\"VisContainer IcecreamContainer\">\n\n    <ContainerDimensions>\n      {\n        dimensions => <IceCreamContainer {...{...props, ...dimensions}} />\n      }\n    </ContainerDimensions>\n    </div>\n  )\n}","import React, { useState, useEffect, useMemo, Suspense } from 'react';\nimport FooterNav from '../FooterNav';\nimport { generatePalette } from '../../helpers/palettes';\n\nimport IceCreamVis from './IceCreamContainer';\n\nimport { VisualizationControlContext } from '../../contexts';\n\nimport { computeFiltersOptions } from '../../helpers/misc';\n\nconst IceCreamAnnotation = ({\n  Content,\n  data,\n  contentsURL,\n  prevPage,\n  nextPage,\n}) => {\n  const filtersOptions = useMemo(() => computeFiltersOptions('table', data), [data]);\n  const [helpVisible, setHelpVisible] = useState(false);\n  const [searchString, setSearchString] = useState('');\n\n  const [xVariable, setXVariable] = useState(undefined);\n  const [yVariable, setYVariable] = useState(undefined);\n  const [reverseX, setReverseX] = useState(false);\n  const [reverseY, setReverseY] = useState(false);\n  const [sizeVariable, setSizeVariable] = useState(undefined);\n  const [colorVariable, setColorVariable] = useState(undefined);\n  const [labelVariable, setLabelVariable] = useState(undefined);\n  const [labelsOnTheSide, setLabelsOnTheSide] = useState(false);\n  const [colorPalette, setColorPalette] = useState(undefined);\n  const [colorScaleType, setColorScaleType] = useState(undefined);\n  const [filtersModeAnd, setFiltersModeAnd] = useState(false);\n  const [title, setTitle] = useState('');\n  const [legend, setLegend] = useState('');\n  const [filters, setFilters] = useState([]);\n\n\n  const [rotateMode, setRotateMode] = useState(false);\n\n  const [focusedVisualizationId, setFocusedVisualizationId] = useState(null);\n  const [registeredVisualizations, setRegisteredVisualizations] = useState({});\n\n  const onRegisterVisualization = (id, props) => {\n    setRegisteredVisualizations({\n      ...registeredVisualizations,\n      [id]: props\n    })\n  }\n\n  const onUnregisterVisualization = id => {\n    const copyOfRegistered = { ...registeredVisualizations };\n    delete copyOfRegistered[id]\n    setRegisteredVisualizations(copyOfRegistered)\n  }\n\n  const onVisualizationUpdate = ({\n    xVariable: thatXVariable,\n    yVariable: thatYVariable,\n\n    reverseX: thatReverseX,\n    reverseY: thatReverseY,\n\n    sizeVariable: thatSizeVariable,\n    colorVariable: thatColorVariable,\n    labelVariable: thatLabelVariable,\n    labelsOnTheSide: thatLabelsOnTheSide,\n    colorScaleType: thatColorScaleType,\n\n    rotateMode: thatRotateMode,\n    searchString: thatSearchString,\n    colorPalette: thatColorPalette,\n    filters: theseFilters = [],\n    filtersModeAnd: theseFiltersModeAnd,\n    title: thisTitle,\n    legend: thisLegend,\n  }) => {\n    setXVariable(thatXVariable);\n    setYVariable(thatYVariable);\n    setReverseX(thatReverseX);\n    setReverseY(thatReverseY);\n    setSizeVariable(thatSizeVariable);\n    setColorVariable(thatColorVariable);\n    setColorScaleType(thatColorScaleType);\n    setLabelVariable(thatLabelVariable);\n    setRotateMode(thatRotateMode);\n    setSearchString(thatSearchString);\n    setLabelsOnTheSide(thatLabelsOnTheSide);\n    setFilters(theseFilters);\n    setFiltersModeAnd(theseFiltersModeAnd);\n    setTitle(thisTitle);\n    setLegend(thisLegend);\n    if (thatColorPalette && colorVariable === thatColorVariable) {\n      setColorPalette(thatColorPalette);\n    } else if (thatColorVariable || colorScaleType !== thatColorScaleType) {\n      let palette = colorVariable && colorVariable !== 'default' ? generatePalette(colorVariable, filtersOptions[colorVariable].options.length) : undefined\n      if (palette) {\n        const colors = generatePalette(thatColorVariable, filtersOptions[thatColorVariable].options.size);\n        // const palette = {};\n        let i = 0;\n        filtersOptions[thatColorVariable].options.forEach(option => {\n          palette[option] = colors[i];\n          i++;\n        });\n      } else {\n        setColorPalette(undefined);\n      }\n      \n      setColorPalette(palette);\n    } else if (colorPalette) {\n      setColorPalette(undefined);\n    }\n  }\n\n  useEffect(() => {\n    if (!focusedVisualizationId && Object.keys(registeredVisualizations).length) {\n      const thatId = Object.keys(registeredVisualizations)[0];\n      setFocusedVisualizationId(thatId);\n      onVisualizationUpdate(registeredVisualizations[thatId]);\n    }\n  }, [registeredVisualizations, focusedVisualizationId])/* eslint react-hooks/exhaustive-deps : 0 */\n\n\n  const onSearchStringChange = str => {\n    setSearchString(str);\n  }\n  return (\n    <VisualizationControlContext.Provider value={{\n      onVisualizationUpdate,\n      onRegisterVisualization,\n      onUnregisterVisualization,\n      focusedVisualizationId,\n      setFocusedVisualizationId,\n      visualizationParams: {\n        xVariable,\n        yVariable,\n\n        reverseX,\n        reverseY,\n\n        sizeVariable,\n        colorVariable,\n        labelVariable,\n        labelsOnTheSide,\n\n        rotateMode,\n        searchString,\n        colorPalette,\n        colorScaleType,\n\n        filters,\n        filtersModeAnd,\n\n        title,\n        legend,\n      }\n    }}>\n      <div className=\"slide-container\">\n        <section>\n          <div>\n            <p>\n              <button className={helpVisible ? 'is-active' : ''} onClick={() => setHelpVisible(!helpVisible)}>\n                Comment modifier cette page ?\n            </button>\n            </p>\n            <ol className={`edit-help ${helpVisible ? 'is-active' : ''}`}>\n              <li>\n                Préalablement se logger dans github si le répertoire est privé\n            </li>\n              <li>\n                Se rendre sur <a target=\"blank\" href={contentsURL}>cette page du répertoire github</a>\n              </li>\n              <li>\n                Cliquer sur le crayon en haut à droite des contenus (il affiche \"edit\" au survol)\n            </li>\n              <li>\n                Faire les modifications puis cliquer sur \"Commit changes\" en bas de la page\n            </li>\n              <li>\n                Attendre 2 minutes puis recharger la page pour voir la version à jour de la page\n            </li>\n            </ol>\n          </div>\n          <Suspense fallback={<div>Chargement</div>}>\n            <Content />\n          </Suspense>\n          <FooterNav prevPage={prevPage} nextPage={nextPage} />\n        </section>\n        <aside>\n          <div className=\"vis\">\n            <IceCreamVis\n              {\n              ...{\n                data,\n                filtersOptions,\n\n                xVariable,\n                reverseX,\n                yVariable,\n                reverseY,\n                sizeVariable,\n                colorVariable,\n                labelVariable,\n                labelsOnTheSide,\n                colorPalette,\n                colorScaleType,\n\n                rotateMode,\n                searchString,\n\n                filtersModeAnd,\n                filters,\n                title,\n                legend,\n\n                onToggleFiltersModeAnd: () => setFiltersModeAnd(!filtersModeAnd),\n                onFiltersChange: (newFilters) => setFilters(newFilters),\n\n                onSearchStringChange,\n                onToggleRotateMode: () => setRotateMode(!rotateMode),\n\n                onXVariableChange: (val) => setXVariable(val),\n                onYVariableChange: (val) => setYVariable(val),\n\n                onToggleReverseX: () => setReverseX(!reverseX),\n                onToggleReverseY: () => setReverseY(!reverseY),\n\n                onColorVariableChange: (val) => setColorVariable(val),\n                onSizeVariableChange: (val) => setSizeVariable(val),\n                onLabelVariableChange: (val) => setLabelVariable(val),\n                onToggleLabelsOnTheSide: val => setLabelsOnTheSide(val),\n                onColorPaletteChange: val => setColorPalette(val),\n                onColorScaleTypeChange: val => setColorScaleType(val),\n                onTitleChange: val => setTitle(val),\n                onLegendChange: val => setLegend(val),\n              }\n              }\n            />\n          </div>\n        </aside>\n      </div>\n    </VisualizationControlContext.Provider>\n  )\n}\n\nexport default IceCreamAnnotation;","import IceCreamAnnotation from './IceCreamAnnotation';\n\nexport default IceCreamAnnotation;","import React, {useState} from 'react';\nimport cx from 'classnames';\n\nimport VariablesEditor from '../VariablesEditor';\nimport ColorLegend from '../ColorLegend';\nimport FiltersEditor from '../FiltersEditor';\n\n\n\nexport default function LinearGraphControls({\n  xVariable,\n  xLabelVariable,\n  // reverseX,\n  graphType,\n  yVariable,\n  // reverseY,\n\n  colorVariable,\n  // searchString,\n  useRelativeScale,\n\n  onToggleFiltersModeAnd,\n  filtersModeAnd,\n  onFiltersChange,\n  filters,\n\n  // onSearchStringChange,\n  onToggleUseRelativeScale,\n  onGraphTypeChange,\n  \n  onXVariableChange,\n  onXLabelVariableChange,\n  onYVariableChange,\n  onColorVariableChange,\n\n  onColorPaletteChange,\n\n  // onToggleReverseX,\n  // onToggleReverseY,\n  \n  filtersOptions,\n  colorPalette,\n}) {\n  // const handleSearchChange = e => onSearchStringChange(e.target.value);\n  const [isMinified, setIsMinified] = useState(true)\n  return (\n    <>\n      <button onClick={() => setIsMinified(!isMinified)} className={cx('minify-button', {'is-active': !isMinified})}>\n        {'éditer'}\n      </button>\n      <ul className={cx(\"VisControls\", {'is-minified': isMinified})}>\n        \n        {/* <li className=\"vis-controls-item\">\n        <form onSubmit={e => e.preventDefault()}>\n          <input type=\"text\" onChange={handleSearchChange} placeholder=\"rechercher\" value={searchString} />\n        </form>\n        </li> */}\n        <li className=\"vis-controls-item\">\n          <VariablesEditor\n            {\n              ...{\n                options: filtersOptions,\n                variables: [\n                  {\n                    title: 'Type de graphe',\n                    onChange: onGraphTypeChange,\n                    localOptions: [[\n                      'linegraph',\n                      {title: 'lignes'}\n                    ], [\n                      'histogram',\n                      {title: 'histogramme'}\n                    ]],\n                    value: graphType,\n                    type: 'string'\n                  },\n                  {\n                    title: 'Variable des X',\n                    onChange: onXVariableChange,\n                    value: xVariable,\n                    type: 'number'\n                  },\n                  {\n                    title: 'Label des X',\n                    onChange: onXLabelVariableChange,\n                    value: xLabelVariable,\n                    type: 'string'\n                  },\n                  // {\n                  //   title: 'Inverser les x',\n                  //   onChange: onToggleReverseX,\n                  //   value: reverseX,\n                  //   type: 'boolean'\n                  // },\n                  {\n                    title: 'Label des Y',\n                    onChange: onYVariableChange,\n                    value: yVariable,\n                    type: 'number'\n                  },\n                  // {\n                  //   title: 'Inverser les y',\n                  //   onChange: onToggleReverseY,\n                  //   value: reverseY,\n                  //   type: 'boolean'\n                  // },\n                  {\n                    title: 'Utiliser une échelle relative pour les Y quand filtré',\n                    onChange: onToggleUseRelativeScale,\n                    value: useRelativeScale,\n                    type: 'boolean'\n                  },\n                  {\n                    title: 'Couleur des points',\n                    onChange: onColorVariableChange,\n                    value: colorVariable,\n                    type: 'color'\n                  },\n                  // {\n                  //   title: 'Labels des points',\n                  //   onChange: onLabelVariableChange,\n                  //   value: labelVariable,\n                  //   type: 'string'\n                  // },\n                ],\n              }\n            }\n          />\n        </li>\n        <li className=\"vis-controls-item\">\n          <FiltersEditor\n            {\n              ...{\n                onToggleFiltersModeAnd,\n                filtersModeAnd,\n                filtersOptions,\n                onFiltersChange,\n                filters\n              }\n            }\n          />\n        </li>\n        {\n            colorVariable && colorVariable !== 'default' ?\n            <ColorLegend\n              colorPalette={colorPalette}\n              onChange={onColorPaletteChange}\n            />\n            : null\n        }\n      </ul>\n    </>\n  );\n}","import React, {useMemo} from 'react';\nimport ContainerDimensions from 'react-container-dimensions';\nimport {scaleLinear} from 'd3-scale';\nimport {extent, group} from 'd3-array';\nimport Input from '../DebouncedInput';\n\n\nimport LinearGraphControls from './LinearGraphControls';\nimport {generatePalette} from '../../helpers/palettes';\nimport {evalIfNodeMatches} from '../../helpers/misc';\n\nimport './LinearGraphContainer.css';\nimport { max, uniqBy } from 'lodash';\n\nfunction LinearGraphContainer({\n\n  width, \n  height,\n  data,\n\n  xVariable,\n  xLabelVariable,\n  reverseX,\n  yVariable,\n  reverseY,\n  sizeVariable,\n  colorVariable,\n  labelVariable,\n  colorPalette: inputColorPalette,\n\n  title,\n  legend,\n\n  searchString = '',\n\n  graphType = 'linegraph',\n  useRelativeScale,\n\n  onSearchStringChange,\n  filtersOptions = {},\n\n  onToggleFiltersModeAnd,\n  filtersModeAnd,\n  onFiltersChange,\n  filters,\n\n  \n  onXVariableChange,\n  onXLabelVariableChange,\n  onYVariableChange,\n  onColorVariableChange,\n  onSizeVariableChange,\n  onLabelVariableChange,\n  onToggleReverseX,\n  onToggleReverseY,\n  onColorPaletteChange,\n  onGraphTypeChange,\n  onToggleUseRelativeScale,\n\n  onTitleChange,\n  onLegendChange,\n}) {\n \n  // const smallestDimension = min([width, height])\n  const WIDTH = width;\n  const HEIGHT = height;\n\n  // set scales dimensions and scale\n  const MARGIN = WIDTH / 10;\n\n  let xRange = [MARGIN, WIDTH - MARGIN / 2];\n  let yRange = [HEIGHT - MARGIN, MARGIN];\n\n\n  const xLabelMap = useMemo(() => {\n    return data.reduce((dict, datum) => {\n      const labelVariable = xLabelVariable === 'default' ? xVariable : xLabelVariable;\n      return {\n        ...dict,\n        [datum[xVariable]]: datum[labelVariable]\n      }\n    }, {})\n\n  }, [data, xVariable, xLabelVariable])\n  \n  // build visualization groups\n  let dataGroups = [[undefined, data]]\n  if (colorVariable) {\n    dataGroups = Array.from(group(data, d => d[colorVariable]));\n  } \n\n  // reduce items\n  dataGroups = dataGroups.map(([_id, values]) => {\n    const xGroups = Array.from(group(values, d => d[xVariable])).map(([x, ys]) => {\n      return {\n        x: +x, \n        // aggregate ys\n        y: ys.reduce((sum, y) => sum + (+y[yVariable]), 0),\n        filteredY: ys.filter(d => filters.length ? evalIfNodeMatches(d, filters, filtersModeAnd) : true).reduce((sum, y) => sum + (+y[yVariable]), 0),\n        xValue: x\n      }\n    })\n    return [_id, xGroups]\n  });\n \n  // refactorize by x for stacked barchart\n  if (graphType === 'histogram') {\n    const xMap = dataGroups.reduce((res, [color, values]) => {\n      return values.reduce((res2, value) => {\n        const x = value.x;\n        const transformedValue = {...value, color};\n        return {\n          ...res2,\n          [x]: res2[x] ? [...res2[x], transformedValue] : [transformedValue]\n        }\n      }, res)\n    }, {})\n    // turn datagroup to an array of [x, list of related objects]\n    dataGroups = Object.entries(xMap);\n  }\n  let getX, getY;\n  const yPropToFilter = useRelativeScale ? 'filteredY' : 'y';\n  let xValues;\n  if (graphType === 'linegraph') {\n    // handling relative or global filter\n    const xExtent = extent(dataGroups.reduce((res, [_id, values]) => [...res, ...values.map(v => v.x)] , []));\n    getX = scaleLinear().range(xRange).domain(xExtent);\n    getY = scaleLinear().range(yRange).domain([0, max(dataGroups.map(([_id, values]) => max(values.map(v => v[yPropToFilter]))))]).nice();\n  } else if (graphType === 'histogram') {\n    const xExtent = extent(dataGroups.map(([x]) => +x));\n    getX = scaleLinear().range(xRange).domain(xExtent);\n    xValues = uniqBy(dataGroups, d => d[0])\n    // y scale domain is the biggest sum for each x modality\n    getY = scaleLinear().range(yRange).domain([0, max(dataGroups.map(([_x, list]) => list.reduce((sum, item) => sum + item[yPropToFilter] , 0)))]).nice();\n  }\n\n   // apply filter\n   if (filters.length && colorVariable) {\n    const filtersAffectingColor = filters.filter(f => f.attribute === colorVariable);\n    if (graphType === 'linegraph') {\n      dataGroups = dataGroups.filter(([colorValue, values]) => {\n        if (filtersAffectingColor) {\n          if (filtersModeAnd) {\n            const oneFilterDoesNotMatches = filtersAffectingColor.find(({ attribute, value }) => colorValue !== '' + value) !== undefined;\n            return !oneFilterDoesNotMatches;\n          } else {\n            const oneFilterMatches = filtersAffectingColor.find(({ attribute, value }) => colorValue === '' + value) !== undefined;\n            return oneFilterMatches;\n          }\n        } else {\n          return true;\n        }\n      })\n     } else if (graphType === 'histogram') {\n       // filtering groups\n      dataGroups = dataGroups.reduce((res, [xValue, values]) => {\n        if (filtersAffectingColor) {\n          const newValues = values.filter(value => {\n            if (filtersModeAnd) {\n              const oneFilterDoesNotMatches = filtersAffectingColor.find(({ attribute, value }) => value.color !== '' + value) !== undefined;\n              return !oneFilterDoesNotMatches;\n            } else {\n              const oneFilterMatches = filtersAffectingColor.find(({ attribute, value }) => value.color === '' + value) !== undefined;\n              return oneFilterMatches;\n            }\n          })\n          if (newValues.length) {\n            return [...res, [xValue, newValues]]\n          // all items filtered out -> do not include the group\n          } else return res;\n        // no filters, return as is\n        } else {\n          return [...res, [xValue, values]];\n        }\n      }, [])\n     }\n    \n  }\n    \n  \n  // manage palette\n  let colorPalette;\n  if (inputColorPalette) {\n    colorPalette = inputColorPalette;\n  }\n  else if (colorVariable && colorVariable !== 'default') {\n    const palette = generatePalette(colorVariable, filtersOptions[colorVariable].options.length);\n    colorPalette = filtersOptions[colorVariable].options.reduce((res, option, index) => ({\n      ...res,\n      [option]: palette[index]\n    }), {})\n  }\n  let getColor = (val) => {\n    return colorPalette ? colorPalette[val] : 'grey';\n  }\n\n  // handling search\n  let highlightedIndex;\n  if (searchString.length && labelVariable) {\n    highlightedIndex = new Set();\n    data.forEach((datum, index) => {\n      const label = datum[labelVariable].toLowerCase();\n      if (label.includes(searchString)) {\n        highlightedIndex.add(index);\n      }\n    })\n  }\n\n  if (reverseX) {\n    xRange = xRange.reverse();\n  }\n  if (reverseY) {\n    yRange = yRange.reverse();\n  }\n  let getYHisto\n  // preparing histogram stacking\n  if (graphType === 'histogram') {\n    dataGroups = dataGroups.map(([xValue, values]) => {\n      // let sum = 0;\n      const newValues = values\n      .sort((a, b) => {\n        if (a.color > b.color) {\n          return 1;\n        } else return -1;\n      })\n      .reduce((total, value, index) => {\n        const prev = index > 0 ? total[index - 1] : undefined;\n        const yDisplace = prev ? +prev.y + (prev.yDisplace || 0) : 0;\n\n        const newValue = {\n          ...value,\n          yDisplace,\n          y: +value.y,\n          x: +value.x\n        }\n        return [...total, newValue]\n      }, [])\n\n      return [xValue, newValues];\n    }, []);\n\n    dataGroups = dataGroups.sort((a, b) => {\n      if (+a[0] > +b[0]) {\n        return 1;\n      }\n      return -1;\n    });\n    getYHisto = scaleLinear()\n    .range([MARGIN, HEIGHT - MARGIN * 2])\n    .domain([0, max(dataGroups.map(([_xValue, values]) => values.reduce((sum, v) => sum + v.y, 0)))]).nice()\n    getY\n    .domain([0, max(dataGroups.map(([_xValue, values]) => values.reduce((sum, v) => sum + v.y, 0)))]).nice()\n  }\n  \n  \n  return (\n    <>\n        <svg transform={`translate(0, ${-MARGIN/2})`} className=\"LinearGraph\" width={WIDTH} height={HEIGHT + MARGIN/2}>\n            <g>\n              {\n                graphType === 'linegraph' ?\n                dataGroups.map(([colorValue, values]) => {\n                  const firstX = getX(values[0].x);\n                  const firstY = getY(values[0].y);\n                  const color = colorVariable ? getColor(colorValue) : 'grey';\n                  const path = `M ${firstX} ${firstY} ${\n                    values\n                    .reduce((res, {x, y}) => {\n                      return `${res} L ${getX(x)} ${getY(y)}`\n                    }, '')\n                  }`\n                  return <>\n                    <path d={path} \n                      fill=\"transparent\" \n                      stroke={ colorVariable ? color : 'grey'}\n                      key={colorValue}\n                    />\n                    {\n                      values.map(({x, y}, index) => (\n                        <circle\n                          key={index}\n                          cx={getX(x)}\n                          cy={getY(y)}\n                          fill={ color }\n                          r={2}\n                        />\n                      ))\n                    }\n                  </>\n                })\n                : \n                <g className=\"histogram-objects\">\n                  {\n                    dataGroups.map(([xValue, values], index) => {\n                      return (\n                        <g key={index} className=\"x-group\">\n                          {\n                            values.map(({x, y, yDisplace, color}, index2) => {\n                             \n                              return (\n                                <rect\n                                  key={index2}\n                                  x={getX(x)}\n                                  y={HEIGHT - getYHisto(yDisplace) - getYHisto(y)}\n                                  width={ (WIDTH - MARGIN * 4) / xValues.length}\n                                  height={getYHisto(y)}\n                                  fill={getColor(color)}\n                                />\n                              )\n                            })\n                          }\n                        </g>\n                      )\n                     \n                    })\n                  }\n                </g>\n              }\n              <g className=\"left-axis\">\n              {\n                getY.ticks &&\n                getY.ticks()\n                .map(tick => {\n                  const x = MARGIN * .7;\n                  return (\n                    <g className=\"axis-element\" key={tick}>\n                      <text textAnchor=\"end\" x={x} y={getY(tick)}>\n                        {tick}\n                      </text>\n                      \n                      <line\n                        x1={x  + MARGIN * .1}\n                        y1={getY(tick)}\n                        x2={MARGIN}\n                        y2={getY(tick)}\n                        stroke={'black'}\n                      />\n                    </g>\n                  )\n                })\n              }\n                <line\n                  stroke={'black'}\n                  y1={MARGIN}\n                  y2={HEIGHT - MARGIN}\n                  x1={MARGIN}\n                  x2={MARGIN}\n                />\n              </g>\n              <g className=\"bottom-axis\">\n                <line\n                  stroke={'black'}\n                  y1={HEIGHT - MARGIN}\n                  y2={HEIGHT - MARGIN}\n                  x1={MARGIN}\n                  x2={WIDTH - MARGIN / 2}\n                />\n                {\n                getX.ticks &&\n                getX.ticks()\n                .map(tick => {\n                  const y = HEIGHT - MARGIN * .75\n                  return (\n                    <g className=\"axis-element\" key={tick}>\n                      <g transform={`translate(${getX(tick)} ${y})`}>\n                        <g transform={'rotate(-45)'}>\n                          <text \n                            textAnchor=\"end\"\n                          >\n                            {xLabelMap[tick]}\n                          </text>\n                        </g>\n                      </g>\n                      <line\n                        y1={HEIGHT - MARGIN}\n                        y2={y - MARGIN * .1}\n                        x1={getX(tick)}\n                        x2={getX(tick)}\n                        stroke={'black'}\n                      />\n                    </g>\n                  )\n                })\n                }\n              </g>\n            </g>\n        </svg>\n        <LinearGraphControls\n          {\n            ...{\n              xVariable,\n              xLabelVariable,\n              yVariable,\n              reverseX,\n              reverseY,\n              sizeVariable,\n              colorVariable,\n              labelVariable,\n              graphType,\n              useRelativeScale,\n\n              searchString,\n\n              onSearchStringChange,\n              \n              onXVariableChange,\n              onXLabelVariableChange,\n              onYVariableChange,\n              onColorVariableChange,\n              onSizeVariableChange,\n              onLabelVariableChange,\n              onToggleReverseX,\n              onToggleReverseY,\n              onColorPaletteChange,\n              onToggleUseRelativeScale,\n              onGraphTypeChange,\n\n              onToggleFiltersModeAnd,\n              filtersModeAnd,\n              onFiltersChange,\n              filters,\n\n              filtersOptions,\n              colorPalette,\n            }\n          }\n        />\n        <form onSubmit={e => {e.preventDefault()}} className=\"caption-editor-container\">\n            <h1 className=\"caption-title-container\">\n              <Input\n                value={title || ''}\n                onChange={val => onTitleChange(val)}\n                placeholder=\"Titre de la visualisation\"\n              />\n            </h1>\n            <div className=\"caption-legend-container\">\n              <Input\n                value={legend || ''}\n                onChange={val => onLegendChange(val)}\n                placeholder=\"Légende de la visualisation\"\n                type=\"textarea\"\n              />\n            </div>\n          </form>\n    </>\n  );\n}\n\nexport default function LinearGraphContainerWithDimensions(props) {\n  return (\n    <div className=\"VisContainer LinearGraphContainer\">\n\n    <ContainerDimensions>\n      {\n        dimensions => <LinearGraphContainer {...{...props, ...dimensions}} />\n      }\n    </ContainerDimensions>\n    </div>\n  )\n}","import React, { useState, useEffect, useMemo, Suspense } from 'react';\nimport FooterNav from '../FooterNav';\nimport { generatePalette } from '../../helpers/palettes';\n\nimport LinearGraphVis from './LinearGraphContainer';\n\nimport { VisualizationControlContext } from '../../contexts';\n\nimport { computeFiltersOptions } from '../../helpers/misc';\n\nconst LinearGraphAnnotation = ({\n  Content,\n  data,\n  contentsURL,\n  prevPage,\n  nextPage,\n}) => {\n  const filtersOptions = useMemo(() => computeFiltersOptions('table', data), [data]);\n  const [helpVisible, setHelpVisible] = useState(false);\n  const [searchString, setSearchString] = useState('');\n\n  const [xVariable, setXVariable] = useState(undefined);\n  const [xLabelVariable, setXLabelVariable] = useState(undefined);\n  const [yVariable, setYVariable] = useState(undefined);\n  const [reverseX, setReverseX] = useState(false);\n  const [reverseY, setReverseY] = useState(false);\n  const [sizeVariable, setSizeVariable] = useState(undefined);\n  const [colorVariable, setColorVariable] = useState(undefined);\n  const [labelVariable, setLabelVariable] = useState(undefined);\n  const [colorPalette, setColorPalette] = useState(undefined);\n  const [graphType, setGraphType] = useState('linegraph');\n  const [useRelativeScale, setUseRelativeScale] = useState(undefined);\n  const [filtersModeAnd, setFiltersModeAnd] = useState(false);\n  const [filters, setFilters] = useState([]);\n  const [title, setTitle] = useState('');\n  const [legend, setLegend] = useState('');\n\n\n  const [focusedVisualizationId, setFocusedVisualizationId] = useState(null);\n  const [registeredVisualizations, setRegisteredVisualizations] = useState({});\n\n  const onRegisterVisualization = (id, props) => {\n    setRegisteredVisualizations({\n      ...registeredVisualizations,\n      [id]: props\n    })\n  }\n\n  const onUnregisterVisualization = id => {\n    const copyOfRegistered = { ...registeredVisualizations };\n    delete copyOfRegistered[id]\n    setRegisteredVisualizations(copyOfRegistered)\n  }\n\n  const onVisualizationUpdate = ({\n    xVariable: thatXVariable,\n    xLabelVariable: thatXLabelVariable,\n    yVariable: thatYVariable,\n\n    reverseX: thatReverseX,\n    reverseY: thatReverseY,\n\n    sizeVariable: thatSizeVariable,\n    colorVariable: thatColorVariable,\n    labelVariable: thatLabelVariable,\n\n    searchString: thatSearchString,\n    colorPalette: thatColorPalette,\n\n    graphType: thatGraphType,\n    useRelativeScale: thatUseRelativeScale,\n\n    filters: theseFilters = [],\n    filtersModeAnd: theseFiltersModeAnd,\n    title: thisTitle,\n    legend: thisLegend,\n  }) => {\n    setXVariable(thatXVariable);\n    setXLabelVariable(thatXLabelVariable);\n    setYVariable(thatYVariable);\n    setReverseX(thatReverseX);\n    setReverseY(thatReverseY);\n    setSizeVariable(thatSizeVariable);\n    setColorVariable(thatColorVariable);\n    setLabelVariable(thatLabelVariable);\n    setSearchString(thatSearchString);\n    setGraphType(thatGraphType);\n    setUseRelativeScale(thatUseRelativeScale);\n    setFilters(theseFilters);\n    setFiltersModeAnd(theseFiltersModeAnd);\n    setTitle(thisTitle);\n    setLegend(thisLegend);\n\n\n    if (thatColorPalette && ((!colorVariable && thatColorVariable) || colorVariable === thatColorVariable)) {\n      setColorPalette(thatColorPalette);\n    } else if (thatColorVariable) {\n      let colors = thatColorVariable && thatColorVariable !== 'default' ? generatePalette(thatColorVariable, filtersOptions[thatColorVariable].options.length) : undefined\n      // const colors = generatePalette(thatColorVariable, filtersOptions[thatColorVariable].options.size);\n      const finalPalette = {};\n      let i = 0;\n      filtersOptions[thatColorVariable].options.forEach(option => {\n        finalPalette[option] = colors[i];\n        i++;\n      });\n      setColorPalette(finalPalette);\n    } else if (colorPalette) {\n      setColorPalette(undefined);\n    }\n  }\n\n  useEffect(() => {\n    if (!focusedVisualizationId && Object.keys(registeredVisualizations).length) {\n      const thatId = Object.keys(registeredVisualizations)[0];\n      setFocusedVisualizationId(thatId)\n      onVisualizationUpdate(registeredVisualizations[thatId])\n    }\n  }, [registeredVisualizations, focusedVisualizationId])/* eslint react-hooks/exhaustive-deps : 0 */\n\n\n  const onSearchStringChange = str => {\n    setSearchString(str);\n  }\n  return (\n    <VisualizationControlContext.Provider value={{\n      onVisualizationUpdate,\n      onRegisterVisualization,\n      onUnregisterVisualization,\n      focusedVisualizationId,\n      setFocusedVisualizationId,\n      visualizationParams: {\n        graphType,\n        useRelativeScale,\n\n        xVariable,\n        xLabelVariable,\n        yVariable,\n\n        reverseX,\n        reverseY,\n\n        sizeVariable,\n        colorVariable,\n\n        searchString,\n        colorPalette,\n\n        filters,\n        filtersModeAnd,\n        \n        title,\n        legend\n      }\n    }}>\n      <div className=\"slide-container\">\n        <section>\n          <div>\n            <p>\n              <button className={helpVisible ? 'is-active' : ''} onClick={() => setHelpVisible(!helpVisible)}>\n                Comment modifier cette page ?\n            </button>\n            </p>\n            <ol className={`edit-help ${helpVisible ? 'is-active' : ''}`}>\n              <li>\n                Préalablement se logger dans github si le répertoire est privé\n            </li>\n              <li>\n                Se rendre sur <a target=\"blank\" href={contentsURL}>cette page du répertoire github</a>\n              </li>\n              <li>\n                Cliquer sur le crayon en haut à droite des contenus (il affiche \"edit\" au survol)\n            </li>\n              <li>\n                Faire les modifications puis cliquer sur \"Commit changes\" en bas de la page\n            </li>\n              <li>\n                Attendre 2 minutes puis recharger la page pour voir la version à jour de la page\n            </li>\n            </ol>\n          </div>\n          <Suspense fallback={<div>Chargement</div>}>\n            <Content />\n          </Suspense>\n          <FooterNav prevPage={prevPage} nextPage={nextPage} />\n        </section>\n        <aside>\n          <div className=\"vis\">\n            <LinearGraphVis\n              {\n              ...{\n                data,\n                filtersOptions,\n\n                xVariable,\n                xLabelVariable,\n                reverseX,\n                yVariable,\n                reverseY,\n                sizeVariable,\n                colorVariable,\n                labelVariable,\n                colorPalette,\n                searchString,\n                useRelativeScale,\n                graphType,\n\n                onSearchStringChange,\n\n                filtersModeAnd,\n                filters,\n\n                title,\n                legend,\n\n                onToggleFiltersModeAnd: () => setFiltersModeAnd(!filtersModeAnd),\n                onFiltersChange: (newFilters) => setFilters(newFilters),\n\n                onXVariableChange: (val) => setXVariable(val),\n                onXLabelVariableChange: (val) => setXLabelVariable(val),\n                onYVariableChange: (val) => setYVariable(val),\n\n                onToggleReverseX: () => setReverseX(!reverseX),\n                onToggleReverseY: () => setReverseY(!reverseY),\n\n                onColorVariableChange: (val) => setColorVariable(val),\n                onColorPaletteChange: val => setColorPalette(val),\n\n                onGraphTypeChange: val => setGraphType(val),\n                onToggleUseRelativeScale: () => setUseRelativeScale(!useRelativeScale),\n\n                onTitleChange: val => setTitle(val),\n                onLegendChange: val => setLegend(val),\n\n              }\n              }\n            />\n          </div>\n        </aside>\n      </div>\n    </VisualizationControlContext.Provider>\n  )\n}\n\nexport default LinearGraphAnnotation;","import GraphAnnotation from './components/GraphAnnotation';\nimport IceCreamAnnotation from './components/IceCreamAnnotation';\nimport LinearGraphAnnotation from './components/LinearGraphAnnotation';\nimport PlainPage from './components/PlainPage';\n\nconst routes = [\n  {\n    title: {\n      fr: 'Introduction',\n      en: 'Introduction',\n    },\n    route: {\n      fr: 'introduction',\n      en: 'introduction',\n    },\n    contents: {\n      fr: '00_home.mdx',\n      en: '00_home.mdx',\n    },\n    Component: PlainPage\n  },\n  {\n    title: {\n      fr: '1. Couverture médias',\n      en: '1. Media coverage',\n    },\n    route: {\n      fr: '01-couverture-media',\n      en: '01-media-coverage',\n    },\n    contents: {\n      fr: '01_couverture_media.mdx',\n      en: '01_couverture_media.mdx'\n    },\n    Component: LinearGraphAnnotation,\n    data: '4average_clusters_unpivoted.csv'\n  },\n  {\n    title: {\n      fr: '2. Détecter les critiques',\n      en: '2. Detecting critiques',\n    },\n    route: {\n      fr: '02-detecter-critiques',\n      en: '02-detect-critiques'\n    },\n    contents: {\n      fr: '02_detectcritic.mdx',\n      en: '02_detectcritic.mdx'\n    },\n    Component: LinearGraphAnnotation,\n    data: 'critic_notcritic_unpivoted.csv',\n  },\n  {\n    title: {\n      fr: '3. Groupes et clusters',\n      en: '3. Graph clusters',\n    },\n    route: {\n      fr: '03-graph-clusters',\n      en: '03-graph-clusters',\n    },\n    contents: {\n      fr: '03_graphclusters.mdx',\n      en: '03_graphclusters.mdx'\n    },\n    data: 'Graph_Critic_EN_algopress_webV2.gexf',\n    Component: GraphAnnotation\n  },\n  {\n    title: {\n      fr: '4. Évolution de l\\'agenda médiatique',\n      en: '4. Evolution of the mediatic agenda',\n    },\n    route: {\n      fr: '04-timeline-clusters',\n      en: '04-timeline-clusters',\n    },\n    contents: {\n      fr: '04_timelineclusters.mdx',\n      en: '04_timelineclusters.mdx',\n    },\n    Component: LinearGraphAnnotation,\n    data: '5average_clusters_unpivoted.csv',\n  },\n  {\n    title: {\n      fr: '5. Topologie du réseau',\n      en: '5. Network topology',\n    },\n    route: {\n      fr: '05-topologie',\n      en: '05-topology',\n    },\n    contents: {\n      fr: '05_toporobotalgo.mdx',\n      en: '05_toporobotalgo.mdx',\n    },\n    data: 'Graph_Critic_EN_algopress_webV2.gexf',\n    Component: GraphAnnotation\n  },\n  {\n    title: {\n      fr: '6. Agents calculateurs',\n      en: '6. Calculating agents',\n    },\n    route: {\n      fr: '06-agents',\n      en: '06-agents',\n    },\n    contents: {\n      fr: '06_explore_entities.mdx',\n      en: '06_explore_entities.mdx',\n    },\n    data: 'Graph_Critic_EN_algopress_webV2.gexf',\n    Component: GraphAnnotation\n  },\n  {\n    title: {\n      fr: '7. Verbes de troubles',\n      en: '7. Trouble verbs',\n    },\n    route: {\n      fr: '07-verbes',\n      en: '07-verbs',\n    },\n    contents: {\n      fr: '07_IssueVERB.mdx',\n      en: '07_IssueVERB.mdx',\n    },\n    data: 'df_AB_tfidf_verbs_freq_count.csv',\n    Component: IceCreamAnnotation\n  },\n  {\n    title: {\n      fr: '8. Temporalité',\n      en: '8. Temporality',\n    },\n    route: {\n      fr: '08-temporalite',\n      en: '08-temporalite',\n    },\n    contents: {\n      fr: '08_NERdate.mdx',\n      en: '08_NERdate.mdx',\n    },\n    Component: IceCreamAnnotation,\n    data: 'date_ner_tfidf_v3.csv'\n  }\n]\n\nexport default routes;","import React, {useState, Suspense} from 'react';\nimport FooterNav from '../FooterNav';\n\nconst PlainPage = ({\n  Content,\n  contentsURL,\n  prevPage,\n  nextPage\n}) => {\n  const [helpVisible, setHelpVisible] = useState(false);\n  return (\n    <div className=\"slide-container without-visualization\">\n      <section>\n        <div>\n          <p>\n            <button className={helpVisible ? 'is-active': ''} onClick={() => setHelpVisible(!helpVisible)}>\n              Comment modifier cette page ?\n            </button>\n          </p>\n          <ol className={`edit-help ${helpVisible ? 'is-active' : ''}`}>\n            <li>\n              Préalablement se logger dans github si le répertoire est privé\n            </li>\n            <li>\n              Se rendre sur <a target=\"blank\" href={contentsURL}>cette page du répertoire github</a>\n            </li>\n            <li>\n              Cliquer sur le crayon en haut à droite des contenus (il affiche \"edit\" au survol)\n            </li>\n            <li>\n              Faire les modifications puis cliquer sur \"Commit changes\" en bas de la page\n            </li>\n            <li>\n              Attendre 2 minutes puis recharger la page pour voir la version à jour de la page\n            </li>\n          </ol>\n        </div>\n        <Suspense fallback={<div>Chargement</div>}>\n          <Content />\n        </Suspense>\n        <FooterNav prevPage={prevPage} nextPage={nextPage} />\n      </section>\n      <aside>\n      </aside>\n  </div>\n  )\n}\n\nexport default PlainPage;","import LinearGraphAnnotation from './LinearGraphAnnotation';\n\nexport default LinearGraphAnnotation;","import React, {useState} from \"react\";\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  NavLink as Link,\n  Redirect,\n  useHistory,\n} from \"react-router-dom\";\n\nimport './App.css';\n\nimport { LanguageContext } from './contexts';\n\n\nimport {repository} from '../package.json';\n\nimport DataLoader from './components/DataLoader';\n\nimport routes from './summary'\n\nconst LANGUAGES = ['fr', 'en'];\n\n\n\nfunction App() {\n\n  const history = useHistory();\n  const [lang, setLang] = useState('fr');\n\n  const renderRoute = ({\n    data, \n    contentsURL, \n    Content, \n    ThatComponent,\n    prevPage,\n    nextPage\n  }) => (\n      <DataLoader url={data ? `${process.env.PUBLIC_URL}/data/${data}` : undefined}>\n        {\n          data => (\n            <ThatComponent\n              {\n                ...{\n                  contentsURL,\n                  Content,\n                  prevPage,\n                  nextPage,\n                  data\n                }\n              }\n            />\n          )\n        }\n      </DataLoader>\n  );\n\n  const onLangChange = (ln) => {\n    if (ln !== lang) {\n      const otherLang = lang;\n      const pathOtherLang = history.location.pathname.split('/').pop();\n      const routeItem = routes.find(route => {\n        return route.route[otherLang] === pathOtherLang;\n      });\n      setLang(ln);\n      if (routeItem) {\n        history.push(`/edition/${ln}/${routeItem.route[ln]}`);\n\n      }\n    }\n    \n  }\n  return (\n    <LanguageContext.Provider value={{lang}}>\n      <div id=\"wrapper\">\n        <nav>\n          <ul>\n            {\n              routes.map(({title, route: inputRoute}, index) => {\n                const route = `/edition/${lang}/${inputRoute[lang]}`\n                return (\n                  <li key={index} className=\"navitem-container\">\n                    <Link to={route}>\n                      {title[lang]}\n                    </Link>\n                  </li>\n                )\n                })\n            }\n            <li className=\"lang-toggle\">\n              <button \n                className={lang === 'fr' ? 'is-active': ''}\n                onClick={() => onLangChange('fr')}\n              >fr</button>\n              <button\n                className={lang === 'en' ? 'is-active': ''}\n                onClick={() => onLangChange('en')}\n              >en</button>\n            </li>\n          </ul>\n        </nav>\n        <main>\n          <Switch>\n            {\n              LANGUAGES.map(lang => {\n                return routes.map(({\n                  // title,\n                  route: inputRoute, \n                  contents,\n                  data,\n                  Component: ThatComponent\n                }, index) => {\n                  const route = `/edition/${lang}/${inputRoute[lang]}`\n                  const prevPage = index > 0 ? routes[index - 1] : undefined;\n                  const nextPage = index < routes.length - 1 ? routes[index + 1] : undefined;\n                  const Content = React.lazy(() => import(`!babel-loader!mdx-loader!./contents/${lang}/${contents[lang]}`))\n                  const contentsURL = `${repository}/blob/main/src/contents/${lang}/${contents[lang]}`;\n                  return (\n                    <Route key={index} path={route}>\n                      {renderRoute({data, contentsURL, Content, ThatComponent, prevPage, nextPage})}\n                    </Route>\n                  )\n                } )\n              })\n            }\n            <Redirect to={`/edition/fr/${routes[0].route['fr']}`} />\n          </Switch>\n        </main>\n      </div>\n    </LanguageContext.Provider>\n  );\n}\n\n\nexport default function Wrapper() {\n  return (\n    <Router>\n      <App />\n    </Router>\n  )\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { uniq } from \"lodash\";\nimport { min, max } from 'd3-array';\n\nconst serializeValue = val => {\n  if (typeof val === 'string')\n    return `'${val}'`;\n  else if (typeof val === 'object')\n    return JSON.stringify(val);\n  else return val;\n}\n\nconst buildComponentCode = (componentName, props) => `<${componentName} \n  ${Object.entries(props)\n    .filter(([_key, val]) => {\n      return !(val === undefined || val === false || val === '' || (Array.isArray(val) && !val.length))\n    })\n    .map(([key, val]) => `${key}={${serializeValue(val)}}`)\n    .join(' \\n  ')\n    .trim()\n  }\n/>`\n\nexport const buildGraphCode = props => buildComponentCode('GraphBlock', props)\n\nexport const buildIceCreamScatterPlotCode = props => buildComponentCode('IceCreamBlock', props)\nexport const buildLinearGraphCode = props => buildComponentCode('LinearGraphBlock', props)\n\nexport const computeFiltersOptions = (type, ...args) => {\n  switch (type) {\n    case 'table':\n      return computeTableOptions(...args);\n    case 'graph':\n    default:\n      return computeGraphFiltersOptions(...args);\n  }\n}\n\nconst computeTableOptions = data => {\n  return data.columns.reduce((res, key) => {\n    const options = uniq(data.map(d => d[key]))\n    let type = 'string';\n\n    // if number\n    if (!options.find(o => isNaN(+o))) {\n      if (!options.find(o => !Number.isInteger(+o))) {\n        type = 'integer';\n      } else {\n        type = 'float'\n      }\n    }\n    const props = {\n      id: key,\n      title: key,\n      type,\n      options\n    }\n    if (['float', 'integer'].includes(type)) {\n      props.options = props.options.map(o => +o);\n      props.min = min(props.options);\n      props.max = max(props.options);\n    }\n    return {\n      ...res,\n      [key]: props\n    }\n  }, {})\n}\nexport const computeGraphFiltersOptions = (graph, gexfData) => {\n  const domparser = new DOMParser()\n  const doc = domparser.parseFromString(gexfData, 'application/xml')\n  const attrs = doc.querySelectorAll('attributes.node attribute');\n  const categories = [];\n\n  const FORBIDDEN_ATTRS = ['weight'];\n\n  attrs.forEach(attr => {\n    const id = attr.getAttribute('id');\n    if (FORBIDDEN_ATTRS.includes(id)) return;\n\n    const title = attr.getAttribute('title');\n    const type = attr.getAttribute('type');\n    categories.push({\n      id,\n      title,\n      type,\n      options: new Set()\n    })\n  })\n  graph.forEachNode((_node, props) => {\n    categories.forEach(cat => {\n      if (!cat.options.has(props[cat.id]))\n        cat.options.add(props[cat.id])\n    })\n  })\n  return categories.reduce((res, cat) => ({ ...res, [cat.id]: cat }), {});\n}\n\nexport const evalIfNodeMatches = (attributes, filters, filtersModeAnd) => {\n  if (!filters.length) {\n    return true;\n  }\n  if (filtersModeAnd) {\n    const oneFilterDoesNotMatch = filters.find(({ attribute, value }) => attributes[attribute] !== '' + value) !== undefined;\n    return !oneFilterDoesNotMatch;\n  } else {\n    const oneFilterMatches = filters.find(({ attribute, value }) => attributes[attribute] === '' + value) !== undefined;\n    return oneFilterMatches;\n  }\n}\n\nconst radiansToDegrees = radians => radians * (180 / Math.PI);\nexport const degreesToRadians = degrees => degrees * (Math.PI / 180);\n\nexport const cartesianToPolar = (x, y) => {\n  const distance = Math.sqrt(x * x + y * y);\n  const radians = Math.atan2(y, x);\n  const degrees = radiansToDegrees(radians);\n  return { distance, radians, degrees }\n}\n\nexport const polarToCartesian = (distance, degrees) => {\n  const radians = degreesToRadians(degrees);\n  return {\n    x: distance * Math.cos(radians),\n    y: distance * Math.sin(radians)\n  }\n}\n\nexport const transformGeometry = ({ x, y }, { rotate, translate }) => {\n  const { degrees, distance } = cartesianToPolar(x, y);\n  let finalDegrees = degrees;\n  if (rotate) {\n    finalDegrees += rotate;\n  }\n  let { x: newX, y: newY } = polarToCartesian(distance, finalDegrees);\n  if (translate) {\n    if (translate.x) {\n      newX += translate.x;\n    }\n    if (translate.y) {\n      newY += translate.y;\n    }\n  }\n  return { x: newX, y: newY }\n}"],"sourceRoot":""}